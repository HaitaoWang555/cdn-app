import{aB as e,o as t,b as n,e as o,U as r,az as a,aA as i,d as s,y as c,u as l,K as u,Q as p,a2 as d,aC as h,aD as m,aE as f,aw as _,ax as A,ay as g,L as w,S as v,R as y,al as b,P,aF as E,_ as R,av as S,M,ar as C}from"./lib-Du4tlIoz.js";import{T as N,E as O,a as D,b as I,c as x,d as L,e as T,f as B,g as W,h as k,i as U,K as F,j as H,k as j,l as K,m as G,n as $,o as q,p as Q,v as V,z,q as X,r as Y,s as J}from"./element-plus-C2MwbI6u.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Z=e(),ee="main-app",te={[ee]:"http://localhost:9000","nested-app":"http://localhost:9002","play-lib-app":"http://localhost:9008","docs-app":"http://localhost:9009"};function ne(e,t){e.detail.data&&e.detail.data[t]&&(e.detail.data[t].routes&&N().setRoutes(e.detail.data[t].routes),e.detail.data[t].finalRouterPath&&N().setFinalRouterPath("/"+t+e.detail.data[t].finalRouterPath))}Object.keys(te).forEach((e=>{te[e]=window.location.origin+"/child/"+e}));const oe=(e,t)=>{const n=e.__vccOpts||e;for(const[o,r]of t)n[o]=r;return n},re={},ae=e=>(a("data-v-bf673dc5"),e=e(),i(),e),ie={class:"overlay"},se=ae((()=>o("div",{class:"tags-view-container"},null,-1))),ce={class:"main"},le=ae((()=>o("div",{class:"breadcrumb"},null,-1))),ue={class:"content"};const pe=oe(re,[["render",function(e,a){const i=O;return t(),n("div",ie,[se,o("div",ce,[le,o("div",ue,[r(i,{rows:5,animated:""})])])])}],["__scopeId","data-v-bf673dc5"]]),de={class:"play-lib-app"},he=["url","baseroute"],me="play-lib-app",fe=s({__name:"play-lib-app",setup(e){const r=c(!0);function a(e){ne(e,me),e.detail.data[me].routes&&d((()=>{r.value=!1}))}return(e,i)=>(t(),n("div",de,[l(r)?(t(),u(pe,{key:0})):p("",!0),o("micro-app",{name:me,url:l(te)[me],iframe:"",baseroute:`/${l(ee)}/${me}`,onDatachange:a},null,40,he)]))}}),_e={class:"nested-app"},Ae=["url","baseroute"],ge="nested-app",we=s({__name:"nested-app",setup(e){const r=c(!0);function a(e){ne(e,ge),e.detail.data[ge].routes&&d((()=>{r.value=!1}))}return(e,i)=>(t(),n("div",_e,[l(r)?(t(),u(pe,{key:0})):p("",!0),o("micro-app",{name:ge,url:l(te)[ge],iframe:"",baseroute:`/${l(ee)}/${ge}`,onDatachange:a},null,40,Ae)]))}}),ve={class:"docs-app"},ye=["url","baseroute"],be="docs-app",Pe=s({__name:"docs-app",setup(e){const r=c(!0);function a(e){ne(e,be),e.detail.data[be].routes&&d((()=>{r.value=!1}))}return(e,i)=>(t(),n("div",ve,[l(r)?(t(),u(pe,{key:0})):p("",!0),o("micro-app",{name:be,url:l(te)[be],iframe:"",baseroute:`/${l(ee)}/${be}`,onDatachange:a},null,40,ye)]))}});function Ee(){return window.__MICRO_APP_ENVIRONMENT__?ee+"Token":window["pro-layout-localStoragePrefix"]||"main-appToken"}function Re(){return localStorage.getItem(Ee())||""}function Se(){localStorage.removeItem(Ee())}const Me={},Ce=function(e,t,n){let o=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link");o=Promise.all(t.map((t=>{if((t=function(e){return"/main-app/"+e}(t))in Me)return;Me[t]=!0;const o=t.endsWith(".css"),r=o?'[rel="stylesheet"]':"";if(!!n)for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.href===t&&(!o||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${t}"]${r}`))return;const a=document.createElement("link");return a.rel=o?"stylesheet":"modulepreload",o||(a.as="script",a.crossOrigin=""),a.href=t,document.head.appendChild(a),o?new Promise(((e,n)=>{a.addEventListener("load",e),a.addEventListener("error",(()=>n(new Error(`Unable to preload CSS for ${t}`))))})):void 0})))}return o.then((()=>e())).catch((e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}))},Ne=h.create({baseURL:"/prod-api"});Ne.interceptors.request.use((e=>{var t;return e.headers&&(e.headers.Authorization="Bearer "+Re()),(null==(t=e.url)?void 0:t.includes("/mock-api"))&&(e.timeout=10),e}),(e=>Promise.reject(e))),Ne.interceptors.response.use((async e=>{var t,n;if((null==(t=e.config.url)?void 0:t.indexOf(".json"))>-1)return e;{const{getMockData:t}=await Ce((()=>import("./mock-prod-B7NoyyWH.js")),__vite__mapDeps([0,1,2,3]));if(null==(n=e.config.url)?void 0:n.includes("/mock-api"))return t(e.config)}const o=e.data;return 200!==o.code?"blob"===e.config.responseType?e:(401===o.code?D.confirm("登录已过期，请重新登录?","警告！",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{Lt.push({path:"/login",query:{redirect:Lt.currentRoute.value.fullPath}})})).catch((()=>{I.error(o.message)})):I.error(o.message),Promise.reject(new Error(o.message||"Error"))):e}),(async e=>{var t;{const{getMockData:n}=await Ce((()=>import("./mock-prod-B7NoyyWH.js")),__vite__mapDeps([0,1,2,3]));if(null==(t=e.config.url)?void 0:t.includes("/mock-api"))return n(e.config)}return x.error(e),Promise.reject(e)}));let Oe="/main-app/";window.__MICRO_APP_ENVIRONMENT__&&(Oe=window.__MICRO_APP_BASE_ROUTE__);const De=m(Oe);function Ie(){const e=f({history:De,scrollBehavior:(e,t,n)=>n||{top:0},routes:It});Lt.matcher=e.matcher}const xe=["/:pathMatch(.*)*"];function Le(e,t){const n=[];return e.forEach((e=>{const o={...e};(function(e,t){return xe.includes(t.path)||e.includes(t.path)})(t,o)&&(o.children&&(o.children=Le(o.children,t)),n.push(o))})),n}function Te(e,t){e.forEach((e=>{e.path&&e.path.startsWith("/")&&(e.path=t+e.path);const n=e.redirect;n&&n.startsWith("/")&&(e.redirect=t+e.redirect),e.children&&e.children.length>0&&Te(e.children,t)}))}const Be=_({id:"useUserStore",state:()=>({token:Re(),name:"",avatar:""}),getters:{},actions:{async login(e){return new Promise(((t,n)=>{var o;(o=e,Ne({url:"/mock-api/oauth/login",method:"post",data:o})).then((e=>{const{data:n}=e.data;var o;this.token=n.token,o=n.token,localStorage.setItem(Ee(),o),t(n.token)})).catch((e=>{n(e)}))}))},async getInfo(){return new Promise(((e,t)=>{Ne({url:"/mock-api/oauth/info",method:"get"}).then((n=>{const{data:o}=n.data;if(!o)return t(new Error("Verification failed, please Login again."));this.name=o.username,this.avatar=o.icon,e(o)})).catch((e=>{t(e)}))}))},async logout(){return new Promise(((e,t)=>{Ne({url:"/mock-api/oauth/logout",method:"post"}).then((()=>{this.token="",this.name="",Se(),Ie(),e()})).catch((e=>{t(e)}))}))},async resetToken(){return new Promise((e=>{this.token="",this.name="",Se(),Ie(),e()}))}}}),We={class:"right-menu"},ke={class:"avatar-wrapper"},Ue=["src"],Fe={class:"user-name"},He=(e=>(a("data-v-f6a717dc"),e=e(),i(),e))((()=>o("span",{style:{display:"block"}},"退出登录",-1))),je=oe(s({__name:"RightContent",setup(e){const a=A(),i=g(),s=Be(),u=c("/main-app/avatar.png");function p(){D.confirm("确定退出么?","警告！",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:(e,t,n)=>{"confirm"===e?(t.confirmButtonLoading=!0,s.logout().then((()=>{n()})).finally((()=>{t.confirmButtonLoading=!1}))):n()}}).then((()=>{I({type:"success",message:"退出成功"}),a.push(`/login?redirect=${i.fullPath}`)}))}return(e,a)=>{const i=L,c=T,d=B;return t(),n("div",We,[r(d,{class:"avatar-container",trigger:"click"},{dropdown:w((()=>[r(c,{class:"user-dropdown"},{default:w((()=>[r(i,{onClick:p},{default:w((()=>[He])),_:1})])),_:1})])),default:w((()=>[o("div",ke,[o("img",{src:l(u),class:"user-avatar"},null,8,Ue),o("span",Fe,v(l(s).name||"-"),1)])])),_:1})])}}}),[["__scopeId","data-v-f6a717dc"]]),Ke={class:"center"},Ge=oe(s({__name:"CenterContent",setup(e){let o=window.location.pathname.split("/")[2];o=Object.keys(te).includes(o)?"/"+o:"/";const a=c(o);return(e,o)=>{const i=W,s=k;return t(),n("div",Ke,[r(s,{"default-active":l(a),mode:"horizontal",router:""},{default:w((()=>[r(i,{index:"/",route:"/"},{default:w((()=>[y("主应用")])),_:1}),r(i,{index:"/docs-app",route:"/docs-app"},{default:w((()=>[y("组件文档")])),_:1}),r(i,{index:"/nested-app",route:"/nested-app"},{default:w((()=>[y("嵌套菜单")])),_:1}),r(i,{index:"/play-lib-app",route:"/play-lib-app"},{default:w((()=>[y("组件演示")])),_:1})])),_:1},8,["default-active"])])}}}),[["__scopeId","data-v-d3987743"]]),$e=s({__name:"BasicLayout",props:{isMicroAppSingle:{type:Boolean,default:!1}},setup(e){const n=e,o={showHeader:!0,showSider:!0,showChangeLocal:!0,showSettings:!1,sidebarLogo:!0,tagsView:!0,breadcrumb:!0,logoUrl:"/main-app/logo.svg",componyTitle:"Ant Design Pro",locale:F};return window.__MICRO_APP_BASE_APPLICATION__&&(n.isMicroAppSingle||(o.tagsView=!1,o.breadcrumb=!1)),window.__MICRO_APP_ENVIRONMENT__&&(o.showHeader=!1,o.showSider=!1),(n,a)=>{const i=b("router-view");return t(),u(l(U),{settings:o,"is-micro-app-single":e.isMicroAppSingle},{navCenter:w((()=>[r(Ge)])),navRight:w((()=>[r(je)])),default:w((()=>[r(i,null,{default:w((({Component:e})=>[(t(),u(P(e)))])),_:1})])),_:1},8,["is-micro-app-single"])}}}),qe={path:"/child",name:"child",component:$e,meta:{hidden:!0},children:[{path:"/play-lib-app/:page*",component:fe,name:"PlayLibApp",meta:{title:"play-lib-app",noCache:!0}},{path:"/nested-app/:page*",component:we,name:"NestedApp",meta:{title:"nested-app",noCache:!0}},{path:"/docs-app/:page*",component:Pe,name:"DocsApp",meta:{title:"docs-app",noCache:!0}}]},Qe=Object.freeze(Object.defineProperty({__proto__:null,default:qe},Symbol.toStringTag,{value:"Module"})),Ve={},ze={class:"markdown-body"},Xe=[E("<h2 data-v-5822518e>项目组成</h2><ul data-v-5822518e><li data-v-5822518e> 公共组件文档及使用案例：提供了公共组件的文档和使用案例，帮助开发人员快速了解和使用项目中的公共组件，促进团队内部的组件共享和复用。 </li><li data-v-5822518e> 三方组件演示案例：展示了三方组件的演示案例，帮助团队成员了解和评估不同的三方组件，从而在项目中选择合适的组件来满足需求。 </li><li data-v-5822518e> 嵌套菜单演示案例：演示了嵌套菜单的使用场景和案例，展示了如何设计和实现具有层次结构的菜单，提升了用户体验和导航的灵活性。 </li></ul><h2 data-v-5822518e>项目优势：</h2><ul data-v-5822518e><li data-v-5822518e> 微前端架构：使用 micro 构建的微前端应用具有模块化和解耦的特点，各个子应用可以独立开发、部署和升级，有利于团队协作和项目的可维护性。 </li><li data-v-5822518e> 组件化开发：通过提供公共组件文档和使用案例，项目促进了组件化开发的实践，提高了代码的复用性和可维护性，加速了开发效率。 </li><li data-v-5822518e> 三方组件集成：展示了三方组件的演示案例，有助于项目团队评估和选择最适合项目需求的三方组件，减少重复开发，加快项目开发速度。 </li><li data-v-5822518e> 交互体验优化：嵌套菜单演示案例展示了对用户交互体验的关注，设计了具有层次结构的菜单，提升了用户对系统功能的探索和使用体验。 </li><li data-v-5822518e> 技术栈多样性：通过采用微前端架构，项目展示了对多种前端技术栈的支持和整合，使得团队可以根据需求选择最适合的技术栈，提高了项目的灵活性和可扩展性。 </li></ul>",4)];const Ye=oe(Ve,[["render",function(e,o){return t(),n("div",ze,Xe)}],["__scopeId","data-v-5822518e"]]),Je={path:"/",name:"Dashboard",redirect:"/welcome",meta:{title:"首页",icon:"dashboard"},component:s({__name:"MainLayout",setup:e=>(e,n)=>(t(),u($e,{"is-micro-app-single":!0}))}),children:[{path:"/welcome",name:"Dashboard",meta:{title:"欢迎"},component:Ye}]},Ze=Object.freeze(Object.defineProperty({__proto__:null,default:Je},Symbol.toStringTag,{value:"Module"})),et=e=>(a("data-v-350bd124"),e=e(),i(),e),tt={class:"errPage-container"},nt=et((()=>o("h1",{class:"text-jumbo text-ginormous"},"Oops!",-1))),ot=et((()=>o("h2",{class:"my-4"},"你没有权限去该页面",-1))),rt=et((()=>o("h6",{class:"my-4"},"如有不满请联系你领导",-1))),at={class:"list-unstyled"},it=et((()=>o("li",null,"或者你可以去:",-1))),st={class:"link-type"},ct=et((()=>o("img",{src:"/main-app/assets/401-HGF6Q5qM.gif",width:"313",height:"428",alt:"Girl has dropped her ice cream."},null,-1))),lt=oe(s({__name:"401",setup(e){const a=A(),i=g();function s(){i.query.noGoBack?a.push({path:"/"}):a.go(-1)}return(e,a)=>{const i=H,c=b("router-link"),l=K,u=j;return t(),n("div",tt,[r(i,{icon:"el-icon-arrow-left",class:"pan-back-btn",onClick:s},{default:w((()=>[y("返回")])),_:1}),r(u,null,{default:w((()=>[r(l,{span:12},{default:w((()=>[nt,ot,rt,o("ul",at,[it,o("li",st,[r(c,{to:"/"},{default:w((()=>[y("返回首页")])),_:1})])])])),_:1}),r(l,{span:12},{default:w((()=>[ct])),_:1})])),_:1})])}}}),[["__scopeId","data-v-350bd124"]]),ut="/main-app/assets/404_cloud-CPexjtDj.png",pt=e=>(a("data-v-a66aeff1"),e=e(),i(),e),dt={class:"wscn-http404-container"},ht={class:"wscn-http404"},mt=E('<div class="pic-404" data-v-a66aeff1><img class="pic-404__parent" src="/main-app/assets/404-N4aRkdWY.png" alt="404" data-v-a66aeff1><img class="pic-404__child left" src="'+ut+'" alt="404" data-v-a66aeff1><img class="pic-404__child mid" src="'+ut+'" alt="404" data-v-a66aeff1><img class="pic-404__child right" src="'+ut+'" alt="404" data-v-a66aeff1></div>',1),ft={class:"bullshit"},_t={class:"bullshit__headline"},At=pt((()=>o("div",{class:"bullshit__info"},"请检查您输入的URL是否正确，或者单击下面的按钮返回主页。",-1))),gt=pt((()=>o("a",{href:"/",class:"bullshit__return-home"},"返回首页",-1))),wt=oe(s({__name:"404",props:{message:{type:String,default:"访问路径错误"}},setup:e=>(r,a)=>(t(),n("div",dt,[o("div",ht,[mt,o("div",ft,[o("div",_t,v(e.message),1),At,gt])])]))}),[["__scopeId","data-v-a66aeff1"]]),vt={id:"userLayout"},yt={class:"main"},bt={class:"text-3xl font-semibold my-20",style:{color:"rgba(0, 0, 0, 0.85)"}},Pt={class:"svg-container"},Et={class:"svg-container"},Rt={class:"flex justify-between items-start"},St={class:"svg-container"},Mt=["src"],Ct=["src"],Nt=oe(s({__name:"login",setup(e){const a=A(),i=g(),s=Be(),u=c(),p=c(!1),d=c(),h=c(),m=c(!0),f=R({username:[{required:!0,trigger:"blur",message:"请输入用户名"}],password:[{required:!0,trigger:"blur",message:"请输入密码"}],captcha:[{required:!0,trigger:"blur",message:"请输入验证码"}]}),_=R({username:"",password:"",captcha:"",captchaKey:""}),P=()=>{u.value.validate((e=>{if(!e)return console.error("error submit!!"),!1;{p.value=!0;const e=Object.assign({},_);e.captchaKey=h.value,s.login(e).then((()=>{const e=i.query&&i.query.redirect;a.push({path:e||"/"}),p.value=!1})).catch((()=>{E(),p.value=!1}))}}))},E=()=>{var e;m.value=!0,h.value=(new Date).getTime()+"",(e=h.value,Ne({url:"/mock-api/oauth/captchaImage/"+e,method:"get"})).then((e=>{d.value=e.data.data})).finally((()=>{m.value=!1}))};return E(),(e,a)=>{const i=$,s=b("svg-icon"),c=q,h=Q,A=H,g=G,R=V;return t(),n("div",vt,[o("div",yt,[o("div",bt,"你好，欢迎来到"+v(l("APP")),1),r(i,{class:"my-20",title:"演示页面，账号密码随便输入",type:"warning",closable:!1}),r(g,{ref_key:"loginForm",ref:u,model:l(_),rules:l(f),"auto-complete":"on","label-position":"left",size:"large"},{default:w((()=>[r(h,{prop:"username",class:"flex"},{default:w((()=>[r(c,{modelValue:l(_).username,"onUpdate:modelValue":a[0]||(a[0]=e=>l(_).username=e),modelModifiers:{trim:!0},placeholder:"请输入用户名",name:"username",type:"text",tabindex:"1","auto-complete":"on",onKeyup:S(P,["enter"])},{prepend:w((()=>[o("span",Pt,[r(s,{"icon-class":"user"})])])),_:1},8,["modelValue"])])),_:1}),r(h,{prop:"password"},{default:w((()=>[r(c,{modelValue:l(_).password,"onUpdate:modelValue":a[1]||(a[1]=e=>l(_).password=e),modelModifiers:{trim:!0},type:"password",placeholder:"请输入密码",name:"password",tabindex:"2","auto-complete":"on","show-password":"",onKeyup:S(P,["enter"])},{prepend:w((()=>[o("span",Et,[r(s,{"icon-class":"password"})])])),_:1},8,["modelValue"])])),_:1}),o("div",Rt,[r(h,{prop:"captcha",class:"flex-1"},{default:w((()=>[r(c,{modelValue:l(_).captcha,"onUpdate:modelValue":a[2]||(a[2]=e=>l(_).captcha=e),modelModifiers:{trim:!0},placeholder:"请输入验证码",type:"text",onKeyup:S(P,["enter"])},{prepend:w((()=>[o("span",St,[r(s,{"icon-class":"list"})])])),_:1},8,["modelValue"])])),_:1}),M((t(),n("div",null,[l(d)?(t(),n("img",{key:0,src:l(d),onClick:E},null,8,Mt)):(t(),n("img",{key:1,src:l("data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAEAAAAAAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAAjAGkDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD99oSWft8pJJAyO/HXr61NVXSLF7C02yTNcSM7uZGRVbDOzBTtGPlDYz3xnqTVpjgUARXlnHfweXJu27lb5XKnKkMOQQeoFK1tG27citu4ORnNeB/B39s24+Lf7W/jvwRDa6fB4a8H2HmJeFW+0TzpIiSMW3lPK+Y7cLnChiecDzu7/wCClOs6x8L/ABt8QtD0vRZvCXhHX7TS4bO4imF7qVu5w83mhwsTNvRlUxttAYHdkEJSuvVJ/Juy/ELNO3nb52v+R9hNGrjDKpGQeR6dKdXI23xl0e7+DUfjqOWRtDm0oavGSoWRojH5gXBP3yOMZ68Vz/7IX7SEH7VHwP0/xZHZppt3JNNa3tmjtItvLG5HDFVyGTY/GQu/buJUmn9px6rcE7xUujOu+IPj6LwHZWP+gX+q3urXX2KxsbLyvPupfLklKqZXSMYjikclnUYQ9TgHD/4W74g/6Jd46/8AAvRv/k+l+Lv/ACP/AMLf+xnm/wDTNqlcxrfxyvvFfh2aP/hH/FXh6xuNZTQTrNtd2LS2Nyb5bNXEZkclfOKjlGBU5wQaAOlj+Levxxqv/Cr/AB3xxzd6MT/6X0n/AAtnXhPu/wCFXeOs9B/pWi+3/T/WnDofi5fCLWbeJNHbWPO+W/8A7EYKIfQxfaMGT/byFz/yz7Vyd78VdQ+F9rrFgdG8SeLl8MW/2zVdXkubOHcXRpmwrOmAq9FRQFGAM9SAdx4B8fw+PLW+P2G/0q80u6+xXtle+V51pL5ccoVjE7xndHLG4Kuww46HIG/Xm3wE1OTXPEXxEvJLWaxkvNftZntpivmW5bRNLJRipI3LnBwSMjg16PG+4sP7px0xQBBqzXC2J+zxxySb0yruUG3cN2CAfmC5IB4JwCQCSLNQ3pYW/wAoydy/w7uNwzxkdu/brz0qagBEOVHbjoa4f47eFfEfizw9Z23h9bG6SS48vVLK81GTT4ry0KksgmjgmdWLrGpwvMbyjIJVh12n3NxNczLJFGsCBfKcPlmPO4EdsYHOeSSMfKC1uk1dWGnY/Ov9j/xDD4o/4KBfFix0268PyWfimO9tUlXVNqmMyhi1oFjYXBAGQuUGwFsjGDxGkfDLV/hv+xp8VPhxqNuy+M5PFun29rpSHddahlo9jwR/ekR1jdlZQQQrHscfqWRmmmLg4Zh+XFJRskvJJ+dncV3dvzuvK6sfJ3iT4Z+J/g3+y9Z2PiBfDK+GfCvgp7VnudbkgmtNRltpI5H8vyGjmbdIsUQMqAb2wCWXan/BGebzf2Tb5f3f7rxDcp8r7j/qYD8wx8p56c8YPfA+sTFkdaeBgVV3zSl3J5fdjHt/lY4P4vnHj/4W+n/CTz9/+oNqdcXbyJD4F0+Obatva/EaVdVGPvSSarK9sep6zy2bDk4GB2wPUvH3gO38eWdmk11fWFzptz9ss7yzdUntZfLeIspYMvMcsiEMpBDn615Po37MVvZeJ5NL1T7ZfSXgl1e18S2c1xb3kNzFPC6/aVLvBJLudJEO0I3kN+6AQUFHoV/8T9R03V5Fbwb4lk0qO4Nqb6FYJGJDFfNECyGUw5GNwXceDs2fPXL+M7mzs/FPxVubiNpNJh8KWx1KNV/1kqpfM4Hq3kGIH22Y71k2vgnxpo/gfXGvvFXjzUtc0W5Npai2+yxQ6vuWNoZVH2ZiifvVWQjcEaOXGQtV/EP7NEs1pY2Oo+Z4y8SeIImh1XXdXM/2GCONOhtbd40bO7aillJG7dIcAEA6z9nC1urG/wDHkF9/x+Q63Zx3GTn94NC0oNz9c16RbRsskjFmIY4AI9M89M98d+APfPN/Cr4aQ/DDw41mt9fate3TrPf6hePvnvphFHD5jH/rnFGoHOAgySck9UpyKAKeqi6aS1FvNHFH5pa4DQtI0kYRvlQgjY27YdxDcBgBkhluVi6rfXb+LbOzjtz9l8hpZJZI2MbHIxtdSQHQquUdV3CQMj/u5FO1QAUUUUAFFFFABRRRQBW1H92FkUsGwV68YIz06dhzUUnJK7nxsR+GI53Z/wAjpjjpxRRQA91xCZNzbk34+Y46nqOh/GrdFFABUMsjJNGo6M2D+RP9KKKAJqKKKAP/2Q=="),onClick:E},null,8,Ct))])),[[R,l(m)]])]),r(A,{loading:l(p),type:"primary",style:{width:"100%","margin-bottom":"30px"},onClick:P},{default:w((()=>[y(" 登录 ")])),_:1},8,["loading"])])),_:1},8,["model","rules"])])])}}}),[["__scopeId","data-v-fbded5e3"]]);const Ot={path:"/error",component:oe({},[["render",function(e,n){const o=b("router-view");return t(),u(o)}]]),redirect:"noRedirect",name:"ErrorPages",meta:{title:"Error Pages",icon:"404",hidden:!0},children:[{path:"401",component:lt,name:"Page401",meta:{title:"401",noCache:!0}},{path:"404",component:wt,name:"Page404",meta:{title:"404",noCache:!0}}]},Dt={path:"/login",name:"login",component:Nt},It=[{path:"/",redirect:"/welcome"},...function(e){const t=Object.values(e).map((e=>e.default)).filter((e=>e)).sort(((e,t)=>{var n,o;return((null==(n=null==e?void 0:e.meta)?void 0:n.sort)||0)-((null==(o=null==t?void 0:t.meta)?void 0:o.sort)||0)})),n=[];for(let o=0;o<t.length;o++){const e=t[o],r=n.find((t=>t&&t.path===e.path));r?r.children.push(...e.children):n.push(e)}return n}(Object.assign({"/src/router/modules/child.ts":Qe,"/src/router/modules/welcome.ts":Ze})),Ot,Dt,{path:"/:pathMatch(.*)*",redirect:"/error/404",meta:{hidden:!0}}],xt=[],Lt=f({history:De,scrollBehavior:(e,t,n)=>n||{top:0},routes:It}),Tt="1.0.0-rc.6",Bt="undefined"!=typeof window,Wt="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:Function("return this")(),kt=()=>!1,Ut=Array.isArray,Ft=Object.assign,Ht=Object.defineProperty,jt=Object.defineProperties,Kt=Object.prototype.toString,Gt=Object.prototype.hasOwnProperty,$t=e=>Kt.call(e);function qt(e){return void 0===e}function Qt(e){return null===e}function Vt(e){return"string"==typeof e}function zt(e){return"boolean"==typeof e}function Xt(e){return"number"==typeof e}function Yt(e){return"function"==typeof e}function Jt(e){return"[object Object]"===$t(e)}function Zt(e){return"[object Promise]"===$t(e)}function en(e){var t;if(Yt(e)){const n=e.toString();return(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e&&Object.getOwnPropertyNames(e.prototype).length>1||/^function\s+[A-Z]/.test(n)||/^class\s+/.test(n)}return!1}function tn(e){var t;return e instanceof URL||!!(null===(t=e)||void 0===t?void 0:t.href)}function nn(e){var t;return e instanceof Element||Vt(null===(t=e)||void 0===t?void 0:t.tagName)}function on(e){var t;return e instanceof Node||Xt(null===(t=e)||void 0===t?void 0:t.nodeType)}function rn(e){return"[object HTMLLinkElement]"===$t(e)}function an(e){return"[object HTMLStyleElement]"===$t(e)}function sn(e){return"[object HTMLScriptElement]"===$t(e)}function cn(e){return"[object DocumentFragment]"===$t(e)}function ln(e){return nn(e)&&"MICRO-APP-BODY"===e.tagName.toUpperCase()}function un(e,t){try{return fn(e).pathname.split(".").pop()===t}catch(n){return!1}}function pn(e,t,n){if(null==e)throw new TypeError("includes target is null or undefined");const o=Object(e),r=parseInt(o.length,10)||0;if(0===r)return!1;n=parseInt(n,10)||0;let a=Math.max(n>=0?n:r+n,0);for(;a<r;){if(t===o[a]||t!=t&&o[a]!=o[a])return!0;a++}return!1}function dn(e,t=null,...n){const o=t&&Vt(t)?` app ${t}:`:"";Vt(e)?console.error(`[micro-app]${o} ${e}`,...n):console.error(`[micro-app]${o}`,e,...n)}function hn(e,t=null,...n){const o=t&&Vt(t)?` app ${t}:`:"";Vt(e)?console.warn(`[micro-app]${o} ${e}`,...n):console.warn(`[micro-app]${o}`,e,...n)}function mn(e,...t){Promise.resolve().then(e.bind(null,...t))}const fn=function(){class e extends URL{}return(t,n)=>n?new e(""+t,n):new e(""+t)}();function _n(e){return e.startsWith("//")?`${Wt.location.protocol}${e}`:e}function An(e,t=null){if(!Vt(e)||!e)return"";try{const{origin:t,pathname:n,search:o}=fn(_n(e),(window.rawWindow||window).location.href),r=`${t}${n}${o}`;return/^https?:\/\//.test(r)?r:""}catch(n){return dn(n,t),""}}function gn(e){return Vt(e)&&e?e.replace(/(^\d+)|([^\w\d-_])/gi,""):""}function wn(e){const{origin:t,pathname:n}=fn(e);if(/\.(\w+)$/.test(n)){const e=`${t}${n}`.split("/");return e.pop(),e.join("/")+"/"}return`${t}${n}/`.replace(/\/\/$/,"/")}function vn(e,t){return!e||/^((((ht|f)tps?)|file):)?\/\//.test(e)||/^(data|blob):/.test(e)?e:fn(e,wn(_n(t))).toString()}function yn(e,t,n,o){let r=0;function a(){++r===e.length&&o&&o()}e.forEach(((e,o)=>{Zt(e)?e.then((e=>{t({data:e,index:o}),a()})).catch((e=>{n({error:e,index:o}),a()})):(t({data:e,index:o}),a())}))}const bn=Wt.requestIdleCallback||function(e){const t=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})}),1)};function Pn(e){return new Promise((t=>{bn((()=>{e(t)}))}))}let En=null;function Rn(e){En=e}function Sn(){return En}function Mn(e){En===e||xn()||(Rn(e),mn((()=>{Rn(null)})))}let Cn=null;function Nn(e){Cn=e}function On(){return Cn}function Dn(e){Cn===e||xn()||(Nn(e),mn((()=>{Nn(null)})))}let In=!1;function xn(){return In}function Ln(e){!1!==e?(Rn(null),Nn(null),e&&!In&&(In=!0,mn((()=>{In=!1})))):In=!1}function Tn(e,t){const n=(window.rawDocument||document).createElement(e,t);return n.__MICRO_APP_NAME__&&delete n.__MICRO_APP_NAME__,n.__PURE_ELEMENT__=!0,n}function Bn(e){return!e||/(^\d)|([^\w\d-_\u4e00-\u9fa5])/gi.test(e)}function Wn(e){return/^body$/i.test(e)||/^head$/i.test(e)||/^html$/i.test(e)||/^title$/i.test(e)||/^:root$/i.test(e)}function kn(e){return function(e){return"undefined"!=typeof ShadowRoot&&e instanceof ShadowRoot}(e)?e.host:e}function Un(e){return e?e.replace(/^\s+|\s+$/g,""):""}function Fn(){return navigator.userAgent.indexOf("Firefox")>-1}function Hn(e){const t={},n=e.split("&");for(const o of n){const e=o.indexOf("="),n=e<0?o:o.slice(0,e),r=e<0?null:o.slice(e+1);if(n in t){let e=t[n];Ut(e)||(e=t[n]=[e]),e.push(r)}else t[n]=r}return t}function jn(e){let t="";for(const n in e){const o=e[n];if(Qt(o))t+=(t.length?"&":"")+n;else{(Ut(o)?o:[o]).forEach((e=>{qt(e)||(t+=(t.length?"&":"")+n,Qt(e)||(t+="="+e))}))}}return t}function Kn(){const e=new Set;return{add:function(t){return e.add(t),()=>!!e.has(t)&&e.delete(t)},list:()=>e}}function Gn(e){const t=e.attributes,n=new Map;for(let o=0;o<t.length;o++)n.set(t[o].name,t[o].value);return n}function $n(e,t){e?e.push((()=>Pn((e=>{t(),e()})))):t()}function qn(e){return(null==e?void 0:e.reduce(((e,t)=>e.then(t)),Promise.resolve()))||null}function Qn(e){return e.startsWith("inline-")}function Vn(e,t,n,...o){try{Yt(e)&&e(...o)}catch(r){dn(`An error occurred in app ${t} window.${n} \n`,null,r)}}const zn=["mounted","unmount"];function Xn(e,t){return zn.includes(e)?`${e}-${t}`:e}function Yn(e,t,n,o){var r;if(!e)return hn(`element does not exist in lifecycle ${n}`,t);e=kn(e),Ln();const a=Ft({name:t,container:e},o&&{error:o}),i=new CustomEvent(n,{detail:a});!function(e,t){Object.defineProperties(e,{currentTarget:{get:()=>t},target:{get:()=>t}})}(i,e),Yt(null===(r=li.options.lifeCycles)||void 0===r?void 0:r[n])&&li.options.lifeCycles[n](i,t),e.dispatchEvent(i)}function Jn(e,t,n={}){var o;const r=new CustomEvent(Xn(t,e.name),{detail:n});null===(o=e.sandBox)||void 0===o||o.microAppWindow.dispatchEvent(r)}function Zn(e,t=null,n={}){return Ln(),Yt(li.options.fetch)?li.options.fetch(e,n,t):window.fetch(e,n).then((e=>e.text()))}class eo{static getInstance(){return this.instance||(this.instance=new eo),this.instance}run(e,t){const n=e.name,o=e.ssrUrl||e.url;(un(o,"js")?Promise.resolve(`<micro-app-head><script src='${o}'><\/script></micro-app-head><micro-app-body></micro-app-body>`):Zn(o,n,{cache:"no-cache"})).then((r=>{if(!r){const t="html is empty, please check in detail";return e.onerror(new Error(t)),dn(t,n)}r=this.formatHTML(o,r,n),t(r,e)})).catch((t=>{dn(`Failed to fetch data from ${e.url}, micro-app stop rendering`,n,t),e.onLoadError(t)}))}formatHTML(e,t,n){return this.processHtml(e,t,n,li.options.plugins).replace(/<head[^>]*>[\s\S]*?<\/head>/i,(e=>e.replace(/<head/i,"<micro-app-head").replace(/<\/head>/i,"</micro-app-head>"))).replace(/<body[^>]*>[\s\S]*?<\/body>/i,(e=>e.replace(/<body/i,"<micro-app-body").replace(/<\/body>/i,"</micro-app-body>")))}processHtml(e,t,n,o){var r;if(!o)return t;const a=[];return o.global&&a.push(...o.global),(null===(r=o.modules)||void 0===r?void 0:r[n])&&a.push(...o.modules[n]),a.length>0?a.reduce(((t,n)=>Jt(n)&&Yt(n.processHtml)?n.processHtml(t,e):t),t):t}}const to=/(^|\s+)(html|:root)(?=[\s>~[.#:]+|$)/,no=/(^|\s+)((html[\s>~]+body)|body)(?=[\s>~[.#:]+|$)/;function oo(e,t){e=t?`${t} ${e}`:e;const n=new Error(e);throw n.reason=e,t&&(n.filename=t),n}class ro{constructor(){this.cssText="",this.prefix="",this.baseURI="",this.linkPath="",this.result="",this.scopecssDisable=!1,this.scopecssDisableSelectors=[],this.scopecssDisableNextLine=!1,this.mediaRule=this.createMatcherForRuleWithChildRule(/^@media *([^{]+)/,"@media"),this.supportsRule=this.createMatcherForRuleWithChildRule(/^@supports *([^{]+)/,"@supports"),this.documentRule=this.createMatcherForRuleWithChildRule(/^@([-\w]+)?document *([^{]+)/,"@document"),this.hostRule=this.createMatcherForRuleWithChildRule(/^@host\s*/,"@host"),this.importRule=this.createMatcherForNoneBraceAtRule("import"),this.charsetRule=this.createMatcherForNoneBraceAtRule("charset"),this.namespaceRule=this.createMatcherForNoneBraceAtRule("namespace"),this.containerRule=this.createMatcherForRuleWithChildRule(/^@container *([^{]+)/,"@container")}exec(e,t,n,o){return this.cssText=e,this.prefix=t,this.baseURI=n,this.linkPath=o||"",this.matchRules(),Fn()?decodeURIComponent(this.result):this.result}reset(){this.cssText=this.prefix=this.baseURI=this.linkPath=this.result="",this.scopecssDisable=this.scopecssDisableNextLine=!1,this.scopecssDisableSelectors=[]}matchRules(){for(this.matchLeadingSpaces(),this.matchComments();this.cssText.length&&"}"!==this.cssText.charAt(0)&&(this.matchAtRule()||this.matchStyleRule());)this.matchComments()}matchStyleRule(){const e=this.formatSelector(!0);return this.scopecssDisableNextLine=!1,e?(this.recordResult(e),this.matchComments(),this.styleDeclarations(),this.matchLeadingSpaces(),!0):oo("selector missing",this.linkPath)}formatSelector(e){const t=this.commonMatch(/^[^{]+/,e);return!!t&&t[0].replace(/(^|,[\n\s]*)([^,]+)/g,((e,t,n)=>((n=Un(n))&&!(this.scopecssDisableNextLine||this.scopecssDisable&&(!this.scopecssDisableSelectors.length||this.scopecssDisableSelectors.includes(n))||to.test(n))&&(n=no.test(n)?n.replace(no,this.prefix+" micro-app-body"):this.prefix+" "+n),t+n)))}styleDeclarations(){return this.matchOpenBrace()?(this.matchAllDeclarations(),!!this.matchCloseBrace()||oo("Declaration missing '}'",this.linkPath)):oo("Declaration missing '{'",this.linkPath)}matchAllDeclarations(e=0){let t=this.commonMatch(/^(?:url\(["']?(?:[^)"'}]+)["']?\)|[^{}/])*/,!0)[0];if(t&&(this.scopecssDisableNextLine||this.scopecssDisable&&!this.scopecssDisableSelectors.length||(t=t.replace(/url\(["']?([^)"']+)["']?\)/gm,((e,t)=>/^((data|blob):|#|%23)/.test(t)||/^(https?:)?\/\//.test(t)?e:(/^((\.\.?\/)|[^/])/.test(t)&&this.linkPath&&(this.baseURI=function(e){const t=e.split("/");return t.pop(),_n(t.join("/")+"/")}(this.linkPath)),`url("${vn(t,this.baseURI)}")`)))),this.recordResult(t)),this.scopecssDisableNextLine=!1,this.cssText){if("/"===this.cssText.charAt(0))"*"===this.cssText.charAt(1)?this.matchComments():this.commonMatch(/\/+/);else if("{"===this.cssText.charAt(0))this.matchOpenBrace(),e++;else if("}"===this.cssText.charAt(0)){if(e<1)return;this.matchCloseBrace(),e--}return this.matchAllDeclarations(e)}}matchAtRule(){return"@"===this.cssText[0]&&(this.scopecssDisableNextLine=!1,this.keyframesRule()||this.mediaRule()||this.customMediaRule()||this.supportsRule()||this.importRule()||this.charsetRule()||this.namespaceRule()||this.containerRule()||this.documentRule()||this.pageRule()||this.hostRule()||this.fontFaceRule()||this.layerRule())}keyframesRule(){if(!this.commonMatch(/^@([-\w]+)?keyframes\s*/))return!1;if(!this.commonMatch(/^[^{]+/))return oo("@keyframes missing name",this.linkPath);if(this.matchComments(),!this.matchOpenBrace())return oo("@keyframes missing '{'",this.linkPath);for(this.matchComments();this.keyframeRule();)this.matchComments();return this.matchCloseBrace()?(this.matchLeadingSpaces(),!0):oo("@keyframes missing '}'",this.linkPath)}keyframeRule(){let e;const t=[];for(;e=this.commonMatch(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)t.push(e[1]),this.commonMatch(/^,\s*/);return!!t.length&&(this.styleDeclarations(),this.matchLeadingSpaces(),!0)}customMediaRule(){return!!this.commonMatch(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/)&&(this.matchLeadingSpaces(),!0)}pageRule(){return!!this.commonMatch(/^@page */)&&(this.formatSelector(!1),this.scopecssDisableNextLine=!1,this.commonHandlerForAtRuleWithSelfRule("page"))}fontFaceRule(){return!!this.commonMatch(/^@font-face\s*/)&&this.commonHandlerForAtRuleWithSelfRule("font-face")}layerRule(){return!!this.commonMatch(/^@layer\s*([^{;]+)/)&&(this.matchOpenBrace()?(this.matchComments(),this.matchRules(),this.matchCloseBrace()?(this.matchLeadingSpaces(),!0):oo("@layer missing '}'",this.linkPath)):!!this.commonMatch(/^[;]+/))}createMatcherForRuleWithChildRule(e,t){return()=>!!this.commonMatch(e)&&(this.matchOpenBrace()?(this.matchComments(),this.matchRules(),this.matchCloseBrace()?(this.matchLeadingSpaces(),!0):oo(`${t} missing '}'`,this.linkPath)):oo(`${t} missing '{'`,this.linkPath))}createMatcherForNoneBraceAtRule(e){const t=new RegExp("^@"+e+"\\s*([^;]+);");return()=>!!this.commonMatch(t)&&(this.matchLeadingSpaces(),!0)}commonHandlerForAtRuleWithSelfRule(e){return this.matchOpenBrace()?(this.matchAllDeclarations(),this.matchCloseBrace()?(this.matchLeadingSpaces(),!0):oo(`@${e} missing '}'`,this.linkPath)):oo(`@${e} missing '{'`,this.linkPath)}matchComments(){for(;this.matchComment(););}matchComment(){if("/"!==this.cssText.charAt(0)||"*"!==this.cssText.charAt(1))return!1;this.scopecssDisableNextLine=!1;let e=2;for(;""!==this.cssText.charAt(e)&&("*"!==this.cssText.charAt(e)||"/"!==this.cssText.charAt(e+1));)++e;if(e+=2,""===this.cssText.charAt(e-1))return oo("End of comment missing",this.linkPath);let t=this.cssText.slice(2,e-2);if(this.recordResult(`/*${t}*/`),t=Un(t.replace(/^\s*!/,"")),"scopecss-disable-next-line"===t)this.scopecssDisableNextLine=!0;else if(/^scopecss-disable/.test(t))if("scopecss-disable"===t)this.scopecssDisable=!0;else{this.scopecssDisable=!0;t.replace("scopecss-disable","").split(",").forEach((e=>{this.scopecssDisableSelectors.push(Un(e))}))}else"scopecss-enable"===t&&(this.scopecssDisable=!1,this.scopecssDisableSelectors=[]);return this.cssText=this.cssText.slice(e),this.matchLeadingSpaces(),!0}commonMatch(e,t=!1){const n=e.exec(this.cssText);if(!n)return;const o=n[0];return this.cssText=this.cssText.slice(o.length),t||this.recordResult(o),n}matchOpenBrace(){return this.commonMatch(/^{\s*/)}matchCloseBrace(){return this.commonMatch(/^}\s*/)}matchLeadingSpaces(){this.commonMatch(/^\s*/)}recordResult(e){Fn()?this.result+=encodeURIComponent(e):this.result+=e}}function ao(e,t,n,o,r){if(!e.__MICRO_APP_HAS_SCOPED__){e.__MICRO_APP_HAS_SCOPED__=!0;let i=null;try{i=io.exec(e.textContent,n,o,r),io.reset()}catch(a){io.reset(),dn("An error occurred while parsing CSS:\n",t,a)}i&&(e.textContent=i)}}let io;function so(e,t,n){if(t.scopecss){const o=co(t.name);if(io||(io=new ro),e.textContent)ao(e,t.name,o,t.url,n);else{const r=new MutationObserver((function(){r.disconnect(),e.textContent&&!e.hasAttribute("data-styled")&&ao(e,t.name,o,t.url,n)}));r.observe(e,{childList:!0})}}return e}function co(e,t=!1){const n=t?"\\":"";return`${li.tagName}${n}[name=${e}${n}]`}function lo(e,t){Object.defineProperties(e,{currentTarget:{get:()=>t},srcElement:{get:()=>t},target:{get:()=>t}})}function uo(e){const t=new CustomEvent("load");lo(t,e),Yt(e.onload)?e.onload(t):e.dispatchEvent(t)}function po(e){const t=new CustomEvent("error");lo(t,e),Yt(e.onerror)?e.onerror(t):e.dispatchEvent(t)}var ho,mo,fo,_o,Ao,go,wo,vo,yo,bo,Po,Eo,Ro=function(){const e=new Map,t=new Map;function n(e){return{setInfo(t,n){e.set(t,n)},getInfo(t){var n;return null!==(n=e.get(t))&&void 0!==n?n:null},hasInfo:t=>e.has(t),deleteInfo:t=>e.delete(t)}}return{link:n(e),script:Object.assign(Object.assign({},n(t)),{deleteInlineInfo(e){e.forEach((e=>{Qn(e)&&t.delete(e)}))}})}}();function So(e,t,n,o=!1){const r=e.getAttribute("rel");let a=e.getAttribute("href"),i=null;if("stylesheet"===r&&a){a=vn(a,n.url);let t=Ro.link.getInfo(a);const r={attrs:Gn(e)};if(t?t.appSpace[n.name]=t.appSpace[n.name]||r:t={code:"",appSpace:{[n.name]:r}},Ro.link.setInfo(a,t),o)return{address:a,linkInfo:t};n.source.links.add(a),i=document.createComment(`link element with href=${a} move to micro-app-head as style element`),t.appSpace[n.name].placeholder=i}else r&&["prefetch","preload","prerender","modulepreload","icon"].includes(r)?o?i=document.createComment(`link element with rel=${r}${a?" & href="+a:""} removed by micro-app`):null==t||t.removeChild(e):a&&Ya.rawSetAttribute.call(e,"href",vn(a,n.url));return o?{replaceComment:i}:i?null==t?void 0:t.replaceChild(i,e):void 0}function Mo(e,t,n,o){const r=Array.from(t.source.links),a=r.map((e=>{const n=Ro.link.getInfo(e);return n.code?n.code:Zn(e,t.name)})),i=o?[]:null;yn(a,(e=>{$n(i,(()=>function(e,t,n,o){const r=Ro.link.getInfo(e);r.code=t;const a=r.appSpace[o.name],i=a.placeholder;if(i){const t=Tn("style");Co(o,e,t,r,a.attrs),i.parentNode?i.parentNode.replaceChild(t,i):n.appendChild(t),a.placeholder=null}}(r[e.index],e.data,n,t)))}),(e=>{dn(e,t.name)}),(()=>{o?o.then((()=>{i.push((()=>Promise.resolve(t.onLoad({html:e})))),qn(i)})):t.onLoad({html:e})}))}function Co(e,t,n,o,r){if(e.scopecss){const r=o.appSpace[e.name];if(r.prefix=r.prefix||co(e.name),r.parsedCode)n.textContent=r.parsedCode;else{const a=function(e,t,n){const o=n.appSpace;for(const r in o)if(r!==e){const e=o[r];if(e.parsedCode)return e.parsedCode.replace(new RegExp(co(r,!0),"g"),t)}}(e.name,r.prefix,o);a?n.textContent=a:(n.textContent=o.code,so(n,e,t)),r.parsedCode=n.textContent}}else n.textContent=o.code;!function(e,t){t.forEach(((t,n)=>{"rel"!==n&&("href"===n&&(n="data-origin-href"),Ya.rawSetAttribute.call(e,n,t))}))}(n,r)}(mo=ho||(ho={})).NAME="name",mo.URL="url",(_o=fo||(fo={})).CREATED="created",_o.LOADING="loading",_o.LOAD_FAILED="load_failed",_o.BEFORE_MOUNT="before_mount",_o.MOUNTING="mounting",_o.MOUNTED="mounted",_o.UNMOUNT="unmount",(go=Ao||(Ao={})).CREATED="created",go.BEFOREMOUNT="beforemount",go.MOUNTED="mounted",go.UNMOUNT="unmount",go.ERROR="error",go.BEFORESHOW="beforeshow",go.AFTERSHOW="aftershow",go.AFTERHIDDEN="afterhidden",(vo=wo||(wo={})).ONMOUNT="onmount",vo.ONUNMOUNT="onunmount",(bo=yo||(yo={})).KEEP_ALIVE_SHOW="keep_alive_show",bo.KEEP_ALIVE_HIDDEN="keep_alive_hidden",(Eo=Po||(Po={})).DESTROY="destroy",Eo.DESTORY="destory",Eo.INLINE="inline",Eo.DISABLESCOPECSS="disableScopecss",Eo.DISABLESANDBOX="disableSandbox",Eo.DISABLE_SCOPECSS="disable-scopecss",Eo.DISABLE_SANDBOX="disable-sandbox",Eo.DISABLE_MEMORY_ROUTER="disable-memory-router",Eo.DISABLE_PATCH_REQUEST="disable-patch-request",Eo.KEEP_ROUTER_STATE="keep-router-state",Eo.KEEP_ALIVE="keep-alive",Eo.CLEAR_DATA="clear-data",Eo.SSR="ssr",Eo.FIBER="fiber";const No="window,self,globalThis,document,Document,Array,Object,String,Boolean,Math,Number,Symbol,Date,Function,Proxy,WeakMap,WeakSet,Set,Map,Reflect,Element,Node,RegExp,Error,TypeError,JSON,isNaN,parseFloat,parseInt,performance,console,decodeURI,encodeURI,decodeURIComponent,encodeURIComponent,navigator,undefined,location,history",Oo=[1,2,3],Do="state",Io="search",xo="native",Lo="native-scope",To="pure",Bo=[Io,Do,xo,Lo,To],Wo=["popstate","hashchange","load","unload","unmount","appstate-change","statechange","mounted"],ko=Wo,Uo=Wo.concat(["unhandledrejection","message"]),Fo=["onpopstate","onhashchange","onload","onunload","onerror"],Ho=Fo,jo=Fo.concat(["onunhandledrejection"]),Ko=["DOMContentLoaded","readystatechange"],Go=["onreadystatechange"],$o=["window","self","globalThis"],qo=["rawWindow","rawDocument"],Qo=["host","hostname","port","protocol","origin"],Vo=["text/javascript","text/ecmascript","application/javascript","application/ecmascript","module","systemjs-module","systemjs-importmap"];function zo(e,t){return t.appSpace[e.name].module&&(!e.useSandbox||e.iframe)}function Xo(e,t){return e.inline||t.appSpace[e.name].inline||zo(e,t)||function(e,t){return t.appSpace[e.name].attrs.has("id")}(e,t)}function Yo(e){return e.iframe?e.sandBox.microAppWindow:Ya.rawWindow}function Jo(e,t,n){return function(e,t,n){const o=t.appSpace;for(const r in o)if(r!==e.name){const e=o[r];if(e.parsedCode===n&&e.parsedFunction)return e.parsedFunction}}(e,t,n)||function(e,t){return new(Yo(e).Function)(t)}(e,n)}function Zo(){const e="inline-"+Math.random().toString(36).substr(2,15);return Ro.script.hasInfo(e)?Zo():e}function er(e,t){return e.useSandbox&&!zo(e,t)}function tr(e,t){return er(e,t)?e.iframe?"iframe":"with":"disable"}function nr(e,t,n,o=!1){var r;let a=null,i=e.getAttribute("src");if(i&&(i=vn(i,n.url)),e.hasAttribute("exclude")||rr(i,n.name))a=document.createComment("script element with exclude attribute removed by micro-app");else{if(e.type&&!Vo.includes(e.type)||e.hasAttribute("ignore")||ar(i,n.name))return(null===(r=Ya.rawDocument)||void 0===r?void 0:r.currentScript)&&delete Ya.rawDocument.currentScript,null;if(Ya.supportModuleScript&&e.noModule||!Ya.supportModuleScript&&"module"===e.type)a=document.createComment((e.noModule?"noModule":"module")+" script ignored by micro-app");else if(i){let t=Ro.script.getInfo(i);const r={async:e.hasAttribute("async"),defer:e.defer||"module"===e.type,module:"module"===e.type,inline:e.hasAttribute("inline"),pure:e.hasAttribute("pure"),attrs:Gn(e)};if(t?t.appSpace[n.name]=t.appSpace[n.name]||r:t={code:"",isExternal:!0,appSpace:{[n.name]:r}},Ro.script.setInfo(i,t),o)return{address:i,scriptInfo:t};n.source.scripts.add(i),a=document.createComment(`script with src='${i}' extract by micro-app`)}else if(e.textContent){const t=Zo(),r={code:e.textContent,isExternal:!1,appSpace:{[n.name]:{async:!1,defer:"module"===e.type,module:"module"===e.type,inline:e.hasAttribute("inline"),pure:e.hasAttribute("pure"),attrs:Gn(e)}}};if(o)return{address:t,scriptInfo:r};n.source.scripts.add(t),Ro.script.setInfo(t,r),a=document.createComment("inline script extract by micro-app")}else o||(a=document.createComment("script element removed by micro-app"))}return o?{replaceComment:a}:null==t?void 0:t.replaceChild(a,e)}function or(e){var t,n,o;return[...(null===(t=li.options.plugins)||void 0===t?void 0:t.global)||[],...(null===(o=null===(n=li.options.plugins)||void 0===n?void 0:n.modules)||void 0===o?void 0:o[e])||[]]}function rr(e,t){if(!e)return!1;return(or(t)||[]).some((t=>!!t.excludeChecker&&t.excludeChecker(e)))}function ar(e,t){if(!e)return!1;return(or(t)||[]).some((t=>!!t.ignoreChecker&&t.ignoreChecker(e)))}function ir(e,t){const n=Array.from(t.source.scripts),o=[],r=[];for(const i of n){const e=Ro.script.getInfo(i),n=e.appSpace[t.name];(!n.defer&&!n.async||t.isPrefetch&&!t.isPrerender)&&(o.push(e.code?e.code:Zn(i,t.name)),r.push([i,e]))}const a=t.isPrefetch||t.fiber?[]:null;o.length?yn(o,(e=>{$n(a,(()=>function(e,t,n,o){if(t.code=n,o.isPrefetch&&2===o.prefetchLevel){const a=t.appSpace[o.name];if(!a.parsedCode&&(a.parsedCode=cr(e,o,n,t),a.sandboxType=tr(o,t),!Xo(o,t)))try{a.parsedFunction=Jo(o,t,a.parsedCode)}catch(r){dn("Something went wrong while handling preloaded resources",o.name,"\n",r)}}}(r[e.index][0],r[e.index][1],e.data,t)))}),(e=>{dn(e,t.name)}),(()=>{a?(a.push((()=>Promise.resolve(t.onLoad({html:e})))),qn(a)):t.onLoad({html:e})})):t.onLoad({html:e})}function sr(e,t,n,o,r){var a;try{!function(e){!function(e){e.sandBox&&(Ya.rawWindow.__MICRO_APP_PROXY_WINDOW__=e.sandBox.proxyWindow)}(e)}(t);const i=n.appSpace[t.name],s=tr(t,n);if(i.parsedCode&&i.sandboxType===s||(i.parsedCode=cr(e,t,n.code,n),i.sandboxType=s,i.parsedFunction=null),Xo(t,n)){const s=r||Tn("script");if(function(e,t,n,o,r,a){if(n){if(Ya.rawSetAttribute.call(o,"type","module"),Qn(e)?o.textContent=t:o.src=e,a){const t=()=>{a.moduleCount&&a.moduleCount--,a(0===a.moduleCount)};Qn(e)?mn(t):o.onload=t}}else o.textContent=t;!function(e,t){t.forEach(((t,n)=>{"type"===n&&"module"===t||"defer"===n||"async"===n||("src"===n&&(n="data-origin-src"),Ya.rawSetAttribute.call(e,n,t))}))}(o,r)}(e,i.parsedCode,zo(t,n),s,i.attrs,o),!r){const e=t.iframe?null===(a=t.sandBox)||void 0===a?void 0:a.microBody:t.querySelector("micro-app-body");null==e||e.appendChild(s)}}else!function(e,t){const n=t.appSpace[e.name];n.parsedFunction||(n.parsedFunction=Jo(e,t,n.parsedCode));n.parsedFunction.call(Yo(e))}(t,n)}catch(i){throw console.error(`[micro-app from ${r?"runDynamicScript":"runScript"}] app ${t.name}: `,i,e),i}}function cr(e,t,n,o){return Jt(li.options.plugins)&&(n=function(e,t,n,o){var r;const a=lr(o.global,t,e);return lr(null===(r=o.modules)||void 0===r?void 0:r[n],a,e)}(e,n,t.name,li.options.plugins)),er(t,o)?t.iframe?`(function(window,self,global,location){;${n}\n${Qn(e)?"":`//# sourceURL=${e}\n`}}).call(window.__MICRO_APP_SANDBOX__.proxyWindow,window.__MICRO_APP_SANDBOX__.proxyWindow,window.__MICRO_APP_SANDBOX__.proxyWindow,window.__MICRO_APP_SANDBOX__.proxyWindow,window.__MICRO_APP_SANDBOX__.proxyLocation);`:`;(function(proxyWindow){with(proxyWindow.__MICRO_APP_WINDOW__){(function(${No}){;${n}\n${Qn(e)?"":`//# sourceURL=${e}\n`}}).call(proxyWindow,${No})}})(window.__MICRO_APP_PROXY_WINDOW__);`:n}function lr(e,t,n){return Ut(e)?e.reduce(((e,t)=>Jt(t)&&Yt(t.loader)?t.loader(e,n):e),t):t}function ur(e,t,n,o){const r=Array.from(e.children);r.length&&r.forEach((e=>{ur(e,t,n,o)}));for(const a of r)rn(a)?a.hasAttribute("exclude")||rr(a.getAttribute("href"),t.name)?e.replaceChild(document.createComment("link element with exclude attribute ignored by micro-app"),a):a.hasAttribute("ignore")||ar(a.getAttribute("href"),t.name)?a.hasAttribute("href")&&Ya.rawSetAttribute.call(a,"href",vn(a.getAttribute("href"),t.url)):So(a,e,t):an(a)?a.hasAttribute("exclude")?e.replaceChild(document.createComment("style element with exclude attribute ignored by micro-app"),a):t.scopecss&&!a.hasAttribute("ignore")&&$n(o,(()=>so(a,t))):sn(a)?nr(a,e,t):"[object HTMLImageElement]"===$t(a)&&a.hasAttribute("src")&&Ya.rawSetAttribute.call(a,"src",vn(a.getAttribute("src"),t.url))}function pr(e,t){const n=t.parseHtmlString(e),o=Ya.rawElementQuerySelector.call(n,"micro-app-head"),r=Ya.rawElementQuerySelector.call(n,"micro-app-body");if(!o||!r){const e=`element ${o?"body":"head"} is missing`;return t.onerror(new Error(e)),dn(e,t.name)}const a=t.isPrefetch||t.fiber?[]:null;ur(n,t,o,a);const i=qn(a);t.source.links.size?Mo(n,t,o,i):i?i.then((()=>t.onLoad({html:n}))):t.onLoad({html:n}),t.source.scripts.size?ir(n,t):t.onLoad({html:n})}const dr=new class{constructor(){this.eventList=new Map,this.queue=[],this.recordStep={},this.process=()=>{var e,t;let n;const o=this.recordStep,r=this.queue;for(this.recordStep={},this.queue=[];n=r.shift();){const r=this.eventList.get(n),a=r.tempData,i=r.force;let s;if(r.tempData=null,r.force=!1,i||!this.isEqual(r.data,a)){r.data=a||r.data;for(const e of r.callbacks){const t=e(r.data);t&&(null!=s?s:s=[]).push(t)}null===(t=(e=o[n]).dispatchDataEvent)||void 0===t||t.call(e),o[n].nextStepList.forEach((e=>e(s)))}}}}isLegalName(e){return!!e||(dn("event-center: Invalid name"),!1)}enqueue(e,t,n){this.recordStep[e]?(this.recordStep[e].nextStepList.push(t),n&&(this.recordStep[e].dispatchDataEvent=n)):this.recordStep[e]={nextStepList:[t],dispatchDataEvent:n},!this.queue.includes(e)&&1===this.queue.push(e)&&mn(this.process)}isEqual(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==t[n])return!1;return!0}on(e,t,n=!1){if(this.isLegalName(e)){if(!Yt(t))return dn("event-center: Invalid callback function");let o=this.eventList.get(e);o?n&&Object.keys(o.data).length&&(!this.queue.includes(e)||this.isEqual(o.data,o.tempData))&&t(o.data):(o={data:{},callbacks:new Set},this.eventList.set(e,o)),o.callbacks.add(t)}}off(e,t){if(this.isLegalName(e)){const n=this.eventList.get(e);n&&(Yt(t)?n.callbacks.delete(t):n.callbacks.clear())}}clearData(e){if(this.isLegalName(e)){const t=this.eventList.get(e);t&&(t.data={})}}dispatch(e,t,n,o,r){if(this.isLegalName(e)){if(!Jt(t))return dn("event-center: data must be object");let a=this.eventList.get(e);a?(a.tempData=Ft({},a.tempData||a.data,t),!a.force&&(a.force=!!o)):(a={data:t,callbacks:new Set},this.eventList.set(e,a),a.force=!0),this.enqueue(e,n,r)}}getData(e){var t;const n=this.eventList.get(e);return null!==(t=null==n?void 0:n.data)&&void 0!==t?t:null}};function hr(e,t){return Vt(e)&&e?t?`__${e}_from_base_app__`:`__${e}_from_micro_app__`:""}class mr{addGlobalDataListener(e,t){const n=this.appName;n&&(e.__APP_NAME__=n,e.__AUTO_TRIGGER__=t),dr.on("global",e,t)}removeGlobalDataListener(e){Yt(e)&&dr.off("global",e)}setGlobalData(e,t,n){Ln(),dr.dispatch("global",e,(e=>Yt(t)&&t(e)),n)}forceSetGlobalData(e,t){this.setGlobalData(e,t,!0)}getGlobalData(){return dr.getData("global")}clearGlobalData(){dr.clearData("global")}clearGlobalDataListener(){const e=this.appName,t=dr.eventList.get("global");if(t)for(const n of t.callbacks)(e&&e===n.__APP_NAME__||!e&&!n.__APP_NAME__)&&t.callbacks.delete(n)}}class fr extends mr{addDataListener(e,t,n){dr.on(hr(gn(e),!1),t,n)}removeDataListener(e,t){Yt(t)&&dr.off(hr(gn(e),!1),t)}getData(e,t=!1){return dr.getData(hr(gn(e),t))}setData(e,t,n,o){dr.dispatch(hr(gn(e),!0),t,(e=>Yt(n)&&n(e)),o)}forceSetData(e,t,n){this.setData(e,t,n,!0)}clearData(e,t=!0){dr.clearData(hr(gn(e),t))}clearDataListener(e){dr.off(hr(gn(e),!1))}}class _r extends mr{constructor(e){super(),this.appName=gn(e),!this.appName&&dn(`Invalid appName ${e}`)}addDataListener(e,t){e.__AUTO_TRIGGER__=t,dr.on(hr(this.appName,!0),e,t)}removeDataListener(e){Yt(e)&&dr.off(hr(this.appName,!0),e)}getData(e=!0){return dr.getData(hr(this.appName,e))}dispatch(e,t,n){Ln(),dr.dispatch(hr(this.appName,!1),e,(e=>Yt(t)&&t(e)),n,(()=>{const t=Wa.get(this.appName);if((null==t?void 0:t.container)&&Jt(e)){const e=new CustomEvent("datachange",{detail:{data:dr.getData(hr(this.appName,!1))}});kn(t.container).dispatchEvent(e)}}))}forceDispatch(e,t){this.dispatch(e,t,!0)}clearData(e=!1){dr.clearData(hr(this.appName,e))}clearDataListener(){dr.off(hr(this.appName,!0))}}function Ar(e){var t,n;if(e){e.umdDataListeners={global:new Set(null===(t=e.umdDataListeners)||void 0===t?void 0:t.global),normal:new Set(null===(n=e.umdDataListeners)||void 0===n?void 0:n.normal)};const o=dr.eventList.get("global");if(o)for(const t of o.callbacks)e.appName===t.__APP_NAME__&&e.umdDataListeners.global.add(t);const r=dr.eventList.get(hr(e.appName,!0));if(r)for(const t of r.callbacks)e.umdDataListeners.normal.add(t)}}function gr(e){if(null==e?void 0:e.umdDataListeners){for(const t of e.umdDataListeners.global)e.addGlobalDataListener(t,t.__AUTO_TRIGGER__);for(const t of e.umdDataListeners.normal)e.addDataListener(t,t.__AUTO_TRIGGER__);wr(e)}}function wr(e){null==e||delete e.umdDataListeners}class vr{constructor(){this.appInstanceMap=Wa}static getInstance(){return this.instance||(this.instance=new vr),this.instance}get(e){return this.appInstanceMap.get(e)}set(e,t){this.appInstanceMap.set(e,t)}getAll(){return Array.from(this.appInstanceMap.values())}clear(){this.appInstanceMap.clear()}}function yr(){br(),vr.getInstance().getAll().forEach((e=>{e.container&&kn(e.container).disconnectedCallback()})),!window.__MICRO_APP_UMD_MODE__&&vr.getInstance().clear()}function br(){window.__MICRO_APP_ENVIRONMENT__&&window.removeEventListener("unmount",yr,!1)}function Pr(e){return zt(e.__MICRO_APP_IS_BOUND_FUNCTION__)?e.__MICRO_APP_IS_BOUND_FUNCTION__:e.__MICRO_APP_IS_BOUND_FUNCTION__=Yt(t=e)&&0===(null===(n=t.name)||void 0===n?void 0:n.indexOf("bound "))&&!t.hasOwnProperty("prototype");var t,n}function Er(e,t,n="WINDOW"){if(Yt(e)&&!function(e){return zt(e.__MICRO_APP_IS_CONSTRUCTOR__)?e.__MICRO_APP_IS_CONSTRUCTOR__:e.__MICRO_APP_IS_CONSTRUCTOR__=en(e)}(e)&&!Pr(e)&&e.bind){const o=`__MICRO_APP_BOUND_${n}_FUNCTION__`;if(e[o])return e[o];const r=e.bind(t);for(const t in e)r[t]=e[t];return e.hasOwnProperty("prototype")&&Ht(r,"prototype",{value:e.prototype,configurable:!0,enumerable:!1,writable:!0}),e[o]=r}return e}class Rr{constructor(e,t){this.rawWindowScopeKeyList=["location"],this.staticEscapeProperties=["System","__cjsWrapper"],this.staticScopeProperties=["webpackJsonp","webpackHotUpdate","Vue","onpopstate","onhashchange"],this.scopeProperties=Array.from(this.staticScopeProperties),this.escapeProperties=[],this.injectedKeys=new Set,this.escapeKeys=new Set,this.appName=e,this.url=t,this.injectReactHMRProperty()}injectReactHMRProperty(){}}class Sr{}function Mr(e,t){const n=Array.from(e.childNodes);n.length&&n.forEach((e=>{Mr(e,t)})),Cr(e,t)}function Cr(e,t){var n,o;if(t&&on(e)&&e.__MICRO_APP_NAME__!==t&&!e.__PURE_ELEMENT__&&!xn()&&(jt(e,{__MICRO_APP_NAME__:{configurable:!0,enumerable:!0,writable:!0,value:t}}),Ua(t))){const r=null===(o=null===(n=Wa.get(t))||void 0===n?void 0:n.sandBox)||void 0===o?void 0:o.proxyWindow;r&&jt(e,{baseURI:{configurable:!0,enumerable:!0,get:()=>r.location.href},ownerDocument:{configurable:!0,enumerable:!0,get:()=>e!==r.document?r.document:null},parentNode:Nr(t,Ya.rawParentNodeDesc),getRootNode:{configurable:!0,enumerable:!0,writable:!0,value:function(){return r.document}}})}return e}function Nr(e,t){return{configurable:!0,enumerable:!0,get(){var n,o,r,a;Dn(e);const i=null===(n=t.get)||void 0===n?void 0:n.call(this);return ln(i)&&(null===(o=Wa.get(e))||void 0===o?void 0:o.container)?(null===(a=(r=li.options).getRootElementParentNode)||void 0===a?void 0:a.call(r,this,e))||Ya.rawDocument.body:i}}}function Or(e,t,n){const{proxyDocument:o,documentEffect:r}=function(e,t){const n=new Map,o=new Map;let r=null,a=null;const{rawDocument:i,rawCreateElement:s,rawCreateElementNS:c,rawAddEventListener:l,rawRemoveEventListener:u}=Ya;function p(t,n){return Cr(s.call(i,t,n),e)}function d(t,n,o){return Cr(c.call(i,t,n,o),e)}function h(e,t,o){const r=n.get(e);r?r.add(t):n.set(e,new Set([t])),t&&(t.__MICRO_APP_MARK_OPTIONS__=o),l.call(i,e,t,o)}function m(e,t,o){const r=n.get(e);(null==r?void 0:r.size)&&r.has(t)&&r.delete(t),u.call(i,e,t,o)}const f=()=>{o.clear(),a=null},_=()=>{a=r||a,n.forEach(((e,t)=>{if(e.size){const n=o.get(t)||[];o.set(t,new Set([...n,...e]))}}))},A=()=>{a&&!r&&(v.onclick=a),o.forEach(((e,t)=>{for(const n of e)v.addEventListener(t,n,null==n?void 0:n.__MICRO_APP_MARK_OPTIONS__)})),f()},g=()=>{Yt(r)&&u.call(i,"click",r),r=null,n.size&&(n.forEach(((e,t)=>{for(const n of e)u.call(i,t,n)})),n.clear())},w=(()=>{var e;const t=new Map([["onclick",e=>{Yt(r)&&u.call(i,"click",r,!1),Yt(e)&&l.call(i,"click",e,!1),r=e}]]),n=(null===(e=li.options)||void 0===e?void 0:e.customProxyDocumentProps)||new Map;return new Map([...t,...n])})(),v=new Proxy(i,{get:(n,o)=>{var a;return Mn(e),"createElement"===o?p:"createElementNS"===o?d:o===Symbol.toStringTag?"ProxyDocument":"defaultView"===o?t.proxyWindow:"onclick"===o?r:"addEventListener"===o?h:"removeEventListener"===o?m:"microAppElement"===o?null===(a=Wa.get(e))||void 0===a?void 0:a.container:"__MICRO_APP_NAME__"===o?e:Er(Reflect.get(n,o),i,"DOCUMENT")},set:(e,t,n)=>{if(w.has(t)){w.get(t)(n)}else"microAppElement"!==t&&Reflect.set(e,t,n);return!0}});return{proxyDocument:v,documentEffect:{reset:f,record:_,rebuild:A,release:g}}}(e,n),a=function(e,t){const{rawDocument:n,rawRootDocument:o}=Ya;class r{static[Symbol.hasInstance](e){let n=e;for(;n;)if(n=Object.getPrototypeOf(n),n===r.prototype)return!0;return e===t||e instanceof o}}return Object.setPrototypeOf(r,o),Object.setPrototypeOf(r.prototype,new Proxy(o.prototype,{get:(t,o)=>(Mn(e),Er(Reflect.get(t,o),n,"DOCUMENT")),set:(e,t,n)=>(Reflect.set(e,t,n),!0)})),r}(e,o);return jt(t,{document:{configurable:!1,enumerable:!0,get:()=>o},Document:{configurable:!1,enumerable:!1,get:()=>a}}),r}function Dr(e,t,n){return function(e){const t=Ya.rawWindow;Object.getOwnPropertyNames(t).filter((e=>/^on/.test(e)&&!Ho.includes(e))).forEach((n=>{const{enumerable:o,writable:r,set:a}=Object.getOwnPropertyDescriptor(t,n)||{enumerable:!0,writable:!0};Ht(e,n,{enumerable:o,configurable:!0,get:()=>t[n],set:(null!=r?r:a)?e=>{t[n]=e}:void 0})}))}(t),function(e,t,n){const o=Ya.rawWindow,r=new Map,a=new Proxy(t,{get:(t,r)=>(Mn(e),Reflect.has(t,r)||Vt(r)&&/^__MICRO_APP_/.test(r)||pn(n.scopeProperties,r)?(pn(qo,r)&&Ln(),Reflect.get(t,r)):Er(Reflect.get(o,r),o)),set:(e,t,r)=>{if(pn(n.rawWindowScopeKeyList,t))Reflect.set(o,t,r);else if(Gt.call(e,t)||!Gt.call(o,t)||pn(n.scopeProperties,t))Reflect.has(e,t)&&!pn(n.scopeProperties,t)||n.injectedKeys.add(t),Reflect.set(e,t,r);else{const a=Object.getOwnPropertyDescriptor(o,t),{configurable:i,enumerable:s,writable:c,set:l}=a;Ht(e,t,{value:r,configurable:i,enumerable:s,writable:null!=c?c:!!l}),n.injectedKeys.add(t)}return(pn(n.escapeProperties,t)||pn(n.staticEscapeProperties,t)&&!Reflect.has(o,t))&&!pn(n.scopeProperties,t)&&(!Reflect.has(o,t)&&n.escapeKeys.add(t),Reflect.set(o,t,r)),!0},has:(e,t)=>pn(n.scopeProperties,t)?n.injectedKeys.has(t)?Reflect.has(e,t):!!e[t]:Reflect.has(e,t)||Reflect.has(o,t),getOwnPropertyDescriptor:(e,t)=>{if(Gt.call(e,t))return r.set(t,"target"),Object.getOwnPropertyDescriptor(e,t);if(Gt.call(o,t)){r.set(t,"rawWindow");const e=Object.getOwnPropertyDescriptor(o,t);return e&&!e.configurable&&(e.configurable=!0),e}},defineProperty:(e,t,n)=>"rawWindow"===r.get(t)?Reflect.defineProperty(o,t,n):Reflect.defineProperty(e,t,n),ownKeys:e=>Reflect.ownKeys(o).concat(Reflect.ownKeys(e)).filter((function(e){return!(e in this)&&(this[e]=!0)}),Object.create(null)),deleteProperty:(e,t)=>!Gt.call(e,t)||(n.injectedKeys.has(t)&&n.injectedKeys.delete(t),n.escapeKeys.has(t)&&Reflect.deleteProperty(o,t),Reflect.deleteProperty(e,t))});n.proxyWindow=a}(e,t,n),function(e,t){const n=new Map,o=new Map,r=new Map,a=new Map,{rawWindow:i,rawAddEventListener:s,rawRemoveEventListener:c,rawDispatchEvent:l,rawSetInterval:u,rawSetTimeout:p,rawClearInterval:d,rawClearTimeout:h}=Ya;function m(e){var n;return ko.includes(e)&&(null===(n=Wa.get(t))||void 0===n?void 0:n.container)?kn(Wa.get(t).container):i}e.addEventListener=function(e,o,r){e=Xn(e,t);const a=n.get(e);a?a.add(o):n.set(e,new Set([o])),o&&(o.__MICRO_APP_MARK_OPTIONS__=r),s.call(m(e),e,o,r)},e.removeEventListener=function(e,o,r){e=Xn(e,t);const a=n.get(e);(null==a?void 0:a.size)&&a.has(o)&&a.delete(o),c.call(m(e),e,o,r)},e.dispatchEvent=function(e){return l.call(m(null==e?void 0:e.type),e)},e.setInterval=function(e,t,...n){const o=u.call(i,e,t,...n);return r.set(o,{handler:e,timeout:t,args:n}),o},e.setTimeout=function(e,t,...n){const o=p.call(i,e,t,...n);return a.set(o,{handler:e,timeout:t,args:n}),o},e.clearInterval=function(e){r.delete(e),d.call(i,e)},e.clearTimeout=function(e){a.delete(e),h.call(i,e)};const f=()=>{o.clear()},_=()=>{o.forEach(((t,n)=>{for(const o of t)e.addEventListener(n,o,null==o?void 0:o.__MICRO_APP_MARK_OPTIONS__)})),f()};return{reset:f,record:()=>{n.forEach(((e,t)=>{if(e.size){const n=o.get(t)||[];o.set(t,new Set([...n,...e]))}}))},rebuild:_,release:e=>{n.size&&(n.forEach(((e,t)=>{for(const n of e)c.call(m(t),t,n)})),n.clear()),e&&(r.forEach(((e,t)=>{d.call(i,t)})),a.forEach(((e,t)=>{h.call(i,t)})),r.clear(),a.clear())}}}(t,e)}function Ir(e,t,n){const o=Ya.rawWindow.history.state,r={__MICRO_APP_STATE__:Ft({},null==o?void 0:o.__MICRO_APP_STATE__,{[e]:{fullPath:n?n.pathname+n.search+n.hash:null,state:null!=t?t:null,mode:Qr(e)}})};return Ft({},o,r)}function xr(e,t){return Jt(null==t?void 0:t.__MICRO_APP_STATE__)&&(qt(t.__MICRO_APP_STATE__[e])||delete t.__MICRO_APP_STATE__[e],Object.keys(t.__MICRO_APP_STATE__).length||delete t.__MICRO_APP_STATE__),Jt(n=t)&&Object.keys(n).length?Ft({},t):null;var n}function Lr(e){var t,n;const o=Ya.rawWindow.history.state;return(null===(n=null===(t=null==o?void 0:o.__MICRO_APP_STATE__)||void 0===t?void 0:t[e])||void 0===n?void 0:n.state)||null}function Tr(e){var t;const n=Ya.rawWindow.history.state;return(null===(t=null==n?void 0:n.__MICRO_APP_STATE__)||void 0===t?void 0:t[e])||null}const Br=/&/g,Wr=/=/g,kr=/%M1/g,Ur=/%M2/g;function Fr(e){return encodeURIComponent(jr(e).replace(Br,"%M1").replace(Wr,"%M2"))}function Hr(e){return jr(e).replace(kr,"&").replace(Ur,"=")}function jr(e){try{const t=decodeURIComponent(e);return e===t||kr.test(t)||Ur.test(t)?t:jr(t)}catch(t){return e}}function Kr(e){var t,n,o,r;const a=Ya.rawWindow.location,i=Ya.rawWindow.history.state;if(Vr(e)){const o=$r(a.search,a.hash),r=(null===(t=o.hashQuery)||void 0===t?void 0:t[e])||(null===(n=o.searchQuery)||void 0===n?void 0:n[e]);return Vt(r)?Hr(r):null}return(null===(r=null===(o=null==i?void 0:i.__MICRO_APP_STATE__)||void 0===o?void 0:o[e])||void 0===r?void 0:r.fullPath)||(Jr(e)?a.pathname+a.search+a.hash:null)}function Gr(e,t){const n=Ya.rawWindow.location;let o=t.pathname+t.search+t.hash,r=!1;if(Vr(e)){let{pathname:t,search:a,hash:i}=n;const s=$r(a,i),c=Fr(o);if(i&&!a){r=!0,s.hashQuery?s.hashQuery[e]=c:s.hashQuery={[e]:c};const t=i.includes("?")?i.slice(0,i.indexOf("?")+1):i+"?";i=t+jn(s.hashQuery)}else s.searchQuery?s.searchQuery[e]=c:s.searchQuery={[e]:c},a="?"+jn(s.searchQuery);return{fullPath:t+a+i,isAttach2Hash:r}}return(zr(e)||Yr(e))&&(o=n.pathname+n.search+n.hash),{fullPath:o,isAttach2Hash:r}}function $r(e,t){const n={};return""!==e&&"?"!==e&&(n.searchQuery=Hn(e.slice(1))),t.includes("?")&&(n.hashQuery=Hn(t.slice(t.indexOf("?")+1))),n}function qr(e){const t=Wa.get(e);return!(!t||t.isPrefetch)}function Qr(e){var t;return null===(t=Wa.get(e))||void 0===t?void 0:t.routerMode}function Vr(e){return Qr(e)===Io}function zr(e){return Qr(e)===Do}function Xr(e){return Qr(e)===xo}function Yr(e){return Qr(e)===To}function Jr(e){return Xr(e)||function(e){return Qr(e)===Lo}(e)}function Zr(e,t){const n=t&&xo||e||li.options["disable-memory-router"]&&xo||li.options["router-mode"]||Io;return Bo.includes(n)?n:Io}function ea(e){const t=Ya.rawWindow,n=t=>{var n,o,r;if(ni({excludeHiddenApp:!0,excludePreRender:!0}).includes(e)&&!t.onlyForBrowser&&(!Jr(e)||!Ya.rawWindow.history.state||Tr(e))){const t=null===(n=Wa.get(e))||void 0===n?void 0:n.container;!function(e,t=0,...n){setTimeout(e.bind(null,...n),t)}((()=>ta(e,Kr(e))),null!==(r=null===(o=t&&kn(t))||void 0===o?void 0:o.getRouterEventDelay())&&void 0!==r?r:0)}};return t.addEventListener("popstate",n),()=>{t.removeEventListener("popstate",n)}}function ta(e,t){const n=Wa.get(e);if(null==n?void 0:n.sandBox){const o=n.sandBox.proxyWindow,r=n.sandBox.microAppWindow;let a=!1;const i=o.location.href;if(t){const n=o.location.hash;_a(e,t,r.location),a=o.location.hash!==n}!function(e,t,n){const o=new PopStateEvent("popstate",{state:Lr(e)});n.dispatchEvent(o),Ua(e)||Yt(t.onpopstate)&&t.onpopstate(o)}(e,o,r),a&&function(e,t,n,o){const r=new HashChangeEvent("hashchange",{newURL:t.location.href,oldURL:o});n.dispatchEvent(r),Ua(e)||Yt(t.onhashchange)&&t.onhashchange(r)}(e,o,r,i),Ln()}}function na(e,t,n){Ln(),qr(e)&&(function(e){const t=new PopStateEvent("popstate",{state:null});e&&(t.onlyForBrowser=!0),Ya.rawWindow.dispatchEvent(t)}(t),n&&function(e){const t=new HashChangeEvent("hashchange",{newURL:Ya.rawWindow.location.href,oldURL:e});Ya.rawWindow.dispatchEvent(t)}(n))}function oa(e,t){const n=Ya.rawWindow.history;function o(n){return function(...o){var r,a,i;o[2]=qt(o[2])||Qt(o[2])||""+o[2]==""?t.href:""+o[2];const s=fn(o[2],t.href),c=s.pathname+s.search+s.hash;Yr(e)||aa(e,n,Gr(e,s),!0,Ir(e,o[0],s),o[1]),c!==t.fullPath&&_a(e,c,t),null===(i=null===(r=Wa.get(e))||void 0===r?void 0:(a=r.sandBox).updateIframeBase)||void 0===i||i.call(a)}}const r=o("pushState"),a=o("replaceState");return Ua(e)?{pushState:r,replaceState:a,go:e=>n.go(e)}:new Proxy(n,{get:(t,n)=>"state"===n?Lr(e):"pushState"===n?r:"replaceState"===n?a:Er(Reflect.get(t,n),t,"HISTORY"),set:(e,t,n)=>(Reflect.set(e,t,n),!0)})}function ra(e,t,n,o=null,r=""){if(qr(e)){("pushState"===t?Ya.rawPushState:Ya.rawReplaceState).call(Ya.rawWindow.history,o,r,n)}}function aa(e,t,n,o,r,a){if(qr(e)){const i=Ya.rawWindow.location,s=i.pathname+i.search+i.hash,c=n.isAttach2Hash&&s!==n.fullPath?i.href:null;ra(e,t,n.fullPath,r,a),s!==n.fullPath&&Vr(e)&&na(e,o,c)}}function ia(e,t,n){aa(e,"replaceState",t,!0,n)}function sa(e){const t=Ya.rawWindow;return function(...n){var o;if((null===(o=t.history.state)||void 0===o?void 0:o.__MICRO_APP_STATE__)&&(!Jt(n[0])||!n[0].__MICRO_APP_STATE__)&&(Vt(n[2])||tn(n[2]))){const e=t.location.href;fn(n[2],e).href===e&&(n[0]=Ft({},n[0],{__MICRO_APP_STATE__:t.history.state.__MICRO_APP_STATE__}))}e.apply(t.history,n),ni({excludeHiddenApp:!0,excludePreRender:!0}).forEach((e=>{if((Vr(e)||zr(e))&&!Kr(e)){const t=Wa.get(e);ia(e,Gr(e,t.sandBox.proxyWindow.location),Ir(e,Lr(e),t.sandBox.proxyWindow.location))}Jr(e)&&!Tr(e)&&ra(e,"replaceState",t.location.href,Ir(e))})),Ln()}}function ca(){const e=Ya.rawWindow;e.history.pushState=sa(Ya.rawPushState),e.history.replaceState=sa(Ya.rawReplaceState)}function la(){const e=Ya.rawWindow;e.history.pushState=Ya.rawPushState,e.history.replaceState=Ya.rawReplaceState}const{router:ua,executeNavigationGuard:pa,clearRouterWhenUnmount:da}=function(){function e(e,t,n,o){const r=t.sandBox.proxyWindow.location,a=fn(n.path,r.href),i=r.pathname+r.search+r.hash,s=a.pathname+a.search+a.hash;if(i!==s||Kr(e)!==s){if(!Yr(e)){!function(e,t,n,o){aa(e,t,Gr(e,n),!1,Ir(e,null!=o?o:null,n)),Ln()}(e,o&&!1!==n.replace||!0===n.replace?"replaceState":"pushState",a,n.state)}Vr(e)||ta(e,s)}}function t(t){return function(n){return new Promise(((o,r)=>{const a=gn(n.name);if(a&&Vt(n.path))if(ni({excludeHiddenApp:!0,excludePreRender:!0}).includes(a)){const r=Wa.get(a);o(r.sandBox.sandboxReady.then((()=>e(a,r,n,t))))}else r(dn("导航失败，请确保子应用渲染后再调用此方法"));else r(dn("navigation failed, name & path are required when use router."+(t?"replace":"push")))}))}}function n(e){return function(...t){return Ya.rawWindow.history[e](...t)}}const o=Kn(),r=Kn();function a(e,t,n,o){Ln();for(const r of o)Yt(r)?r(t,n,e):Jt(r)&&Yt(r[e])&&r[e](t,n)}function i(e){if(Vr(e)||zr(e)){const t=Wa.get(e);ia(e,Gr(e,t.sandBox.proxyWindow.location),Ir(e,Lr(e),t.sandBox.proxyWindow.location))}}const s=Object.assign(Object.assign({current:new Map,encode:Fr,decode:Hr,push:t(!1),replace:t(!0),go:n("go"),back:n("back"),forward:n("forward"),beforeEach:o.add,afterEach:r.add,attachToURL:function(e){(e=gn(e))&&ni().includes(e)&&i(e)},attachAllToURL:function({includeHiddenApp:e=!1,includePreRender:t=!1}){ni({excludeHiddenApp:!e,excludePreRender:!t}).forEach((e=>i(e)))}},function(){const e=function(){const e=new Map;return{add:function(t,n){return e.set(t,n),()=>!!e.has(t)&&e.delete(t)},get:t=>e.get(t),delete:t=>!!e.has(t)&&e.delete(t)}}();return{setDefaultPage:function(t){const n=gn(t.name);return n&&t.path?e.add(n,t.path):kt},removeDefaultPage:function(t){return!!(t=gn(t))&&e.delete(t)},getDefaultPage:e.get}}()),function(){let e=null;return{setBaseAppRouter:function(t){var n;Qt(n=t)||"object"!=typeof n||(e=new Proxy(t,{get:(e,t)=>(Ln(),Er(Reflect.get(e,t),e,"BASEROUTER")),set:(e,t,n)=>(Reflect.set(e,t,n),!0)}))},getBaseAppRouter:()=>e}}());return{router:s,executeNavigationGuard:function(e,t,n){s.current.set(e,t),a(e,t,n,o.list()),bn((()=>{a(e,t,n,r.list())}))},clearRouterWhenUnmount:function(e){s.current.delete(e)}}}(),ha=["href","pathname","search","hash","host","hostname","port","protocol","search","origin","fullPath"];function ma(e,t,n,o,r,a){const i=Ya.rawWindow.location,s=!!n,c=fn(t);function l(){return s?n.location:c}function u(t,n){const o=fn(t,_.href);if(o.origin===_.origin){const t=Gr(e,o);if(!Jr(e)){if(n=Yr(e)?"replaceState":n,o.pathname===_.pathname&&o.search===_.search){let r=null;return(o.hash!==_.hash||Yr(e))&&(t.isAttach2Hash&&(r=i.href),Yr(e)&&o.hash||ra(e,n,t.fullPath,Vr(e)?null:Ir(e,null,o))),void(o.hash?Vr(e)?na(e,!1,r):ta(e,o.pathname+o.search+o.hash):f())}return ra(e,n,t.fullPath,Vr(e)?null:Ir(e,null,o)),void f()}return t.fullPath}return t}function p(n,o){const r=fn(n,t);r[o]===_[o]&&_.hash?na(e,!1):(ra(e,r[o]===_[o]||Yr(e)?"replaceState":"pushState",Gr(e,r).fullPath,Vr(e)?null:Ir(e,null,r)),f())}const d=t=>function(n){if(qr(e)){const e=u(n,"assign"===t?"pushState":"replaceState");e&&i[t](fn(e,i.origin).href)}},h=d("assign"),m=d("replace"),f=e=>i.reload(e);Ht(l(),"fullPath",{enumerable:!0,configurable:!0,get:()=>_.pathname+_.search+_.hash});const _=new Proxy({},{get:(t,n)=>{const c=l();if("assign"===n)return h;if("replace"===n)return m;if("reload"===n)return f;if("self"===n)return c;if("fullPath"===n)return c.fullPath;if(Qo.includes(n)){if(Xr(e))return i[n];if(s)return o[n]}if("href"===n){if(Xr(e))return c[n].replace(c.origin,i.origin);if(s)return c[n].replace(r,a)}return Er(Reflect.get(c,n),c,"LOCATION")},set:(n,o,r)=>{if(qr(e)){const n=l();if("href"===o){const e=u(r,"pushState");e&&(i.href=fn(e,i.origin).href)}else if("pathname"===o)if(Jr(e))i.pathname=r;else{p(("/"+r).replace(/^\/+/,"/")+_.search+_.hash,"pathname")}else if("search"===o)if(Jr(e))i.search=r;else{p(_.pathname+("?"+r).replace(/^\?+/,"?")+_.hash,"search")}else if("hash"===o)if(Jr(e))i.hash=r;else{const n=_.pathname+_.search+("#"+r).replace(/^#+/,"#"),o=fn(n,t);o.hash!==_.hash&&(Yr(e)||aa(e,"pushState",Gr(e,o),!1,Ir(e,null,o)),Vr(e)||ta(e,o.pathname+o.search+o.hash))}else Reflect.set(n,o,r)}return!0}});return _}function fa(e,t){const n=Ft({name:e},t);for(const o of ha)n[o]=t[o];return n}function _a(e,t,n,o){var r;const a=fa(e,n),i=fn(t,n.href);if(Ua(e)){const t=Wa.get(e).sandBox.microAppWindow;null===(r=t.rawReplaceState)||void 0===r||r.call(t.history,Lr(e),"",i.href)}else{let e=i.href;n.self.origin!==i.origin&&(e=e.replace(i.origin,n.self.origin)),n.self.href=e}const s=Ya.rawWindow.location;Jr(e)&&t!==s.pathname+s.search+s.hash&&"prevent"!==o&&ra(e,"replaceState",t,Ya.rawWindow.history.state);const c=fa(e,n);("auto"===o||a.fullPath!==c.fullPath&&"prevent"!==o)&&pa(e,c,a)}function Aa(e,t,n){const o=Kr(e);o?(_a(e,o,t,"auto"),Yr(e)&&va(e)):ga(e,t,n)}function ga(e,t,n){n&&_a(e,n,t,"prevent"),Yr(e)||ia(e,Gr(e,t),Ir(e,null,t)),function(e,t){pa(e,fa(e,t),fa(e,t))}(e,t)}function wa(e,t,n,o){if(!o&&!Jr(e)){const{pathname:o,search:r,hash:a}=fn(t);_a(e,o+r+a,n,"prevent")}Yr(e)||va(e),da(e)}function va(e){ia(e,function(e){var t,n,o,r;let{pathname:a,search:i,hash:s}=Ya.rawWindow.location,c=!1;if(Vr(e)){const a=$r(i,s);if(null===(t=a.hashQuery)||void 0===t?void 0:t[e]){c=!0,null===(n=a.hashQuery)||void 0===n||delete n[e];const t=jn(a.hashQuery);s=s.slice(0,s.indexOf("?")+Number(Boolean(t)))+t}else if(null===(o=a.searchQuery)||void 0===o?void 0:o[e]){null===(r=a.searchQuery)||void 0===r||delete r[e];const t=jn(a.searchQuery);i=t?"?"+t:""}}return{fullPath:a+i+s,isAttach2Hash:c}}(e),xr(e,Ya.rawWindow.history.state))}function ya(e,t){const n=qt(t)?Ya.rawWindow.fetch:t;return Yt(n)?function(t,o,...r){return(Vt(t)||tn(t))&&(t=fn(t,e).toString()),Ln(),n.call(Ya.rawWindow,t,o,...r)}:n}function ba(e,t){const n=qt(t)?Ya.rawWindow.XMLHttpRequest:t;return en(n)?class extends n{open(t,n,...o){(Vt(n)&&!/^f(ile|tp):\/\//.test(n)||tn(n))&&(n=fn(n,e).toString()),Ln(),super.open(t,n,...o)}}:n}const{createMicroEventSource:Pa,clearMicroEventSource:Ea}=function(){let e;return{createMicroEventSource:function(t,n,o){const r=qt(o)?Ya.rawWindow.EventSource:o;return en(r)?class extends r{constructor(o,r,...a){if((Vt(o)||tn(o))&&(o=fn(o,n).toString()),Ln(),super(o,r,...a),e){const n=e.get(t);n?n.add(this):e.set(t,new Set([this]))}else e=new Map([[t,new Set([this])]])}close(){var n;super.close(),null===(n=e.get(t))||void 0===n||n.delete(this)}}:r},clearMicroEventSource:function(t){const n=null==e?void 0:e.get(t);(null==n?void 0:n.size)&&(n.forEach((e=>{e.close()})),n.clear())}}}();class Ra extends Rr{constructor(e,t){super(e,t),this.active=!1,this.microAppWindow=new Sr,this.patchWith((n=>{this.getSpecialProperties(e),this.patchRouter(e,t,this.microAppWindow),this.windowEffect=Dr(e,this.microAppWindow,this),this.documentEffect=Or(e,this.microAppWindow,this),this.setMappingPropertiesWithRawDescriptor(this.microAppWindow),this.initStaticGlobalKeys(e,t,this.microAppWindow),n()}))}start({umdMode:e,baseroute:t,defaultPage:n,disablePatchRequest:o}){this.active||(this.active=!0,this.initRouteState(n),this.removeHistoryListener=ea(this.microAppWindow.__MICRO_APP_NAME__),Jr(this.microAppWindow.__MICRO_APP_NAME__)&&(this.microAppWindow.__MICRO_APP_BASE_ROUTE__=this.microAppWindow.__MICRO_APP_BASE_URL__=t),e||this.initGlobalKeysWhenStart(this.microAppWindow.__MICRO_APP_NAME__,this.microAppWindow.__MICRO_APP_URL__,this.microAppWindow,o),1==++Ya.activeSandbox&&(Qa(),ca()),1==++Ra.activeCount&&window.__MICRO_APP_ENVIRONMENT__&&(br(),window.addEventListener("unmount",yr,!1)),Ya.rawWindow._babelPolyfill&&(Ya.rawWindow._babelPolyfill=!1))}stop({umdMode:e,keepRouteState:t,destroy:n,clearData:o}){var r;this.active&&(this.recordAndReleaseEffect({umdMode:e,clearData:o,destroy:n},!e||n),this.clearRouteState(t),null===(r=this.removeHistoryListener)||void 0===r||r.call(this),e&&!n||(Ea(this.microAppWindow.__MICRO_APP_NAME__),this.injectedKeys.forEach((e=>{Reflect.deleteProperty(this.microAppWindow,e)})),this.injectedKeys.clear(),this.escapeKeys.forEach((e=>{Reflect.deleteProperty(Ya.rawWindow,e)})),this.escapeKeys.clear(),this.clearHijackUmdHooks()),0==--Ya.activeSandbox&&(za(),la()),--Ra.activeCount,this.active=!1)}initStaticGlobalKeys(e,t,n){n.__MICRO_APP_ENVIRONMENT__=!0,n.__MICRO_APP_NAME__=e,n.__MICRO_APP_URL__=t,n.__MICRO_APP_PUBLIC_PATH__=wn(t),n.__MICRO_APP_BASE_ROUTE__="",n.__MICRO_APP_WINDOW__=n,n.__MICRO_APP_PRE_RENDER__=!1,n.__MICRO_APP_UMD_MODE__=!1,n.__MICRO_APP_PROXY_WINDOW__=this.proxyWindow,n.__MICRO_APP_SANDBOX__=this,n.__MICRO_APP_SANDBOX_TYPE__="with",n.rawWindow=Ya.rawWindow,n.rawDocument=Ya.rawDocument,n.microApp=Ft(new _r(e),{removeDomScope:Ln,pureCreateElement:Tn,location:n.location,router:ua})}recordAndReleaseEffect(e,t=!1){t?this.resetEffectSnapshot():this.recordEffectSnapshot(),this.releaseGlobalEffect(e)}resetEffectSnapshot(){this.windowEffect.reset(),this.documentEffect.reset(),wr(this.microAppWindow.microApp)}recordEffectSnapshot(){this.windowEffect.record(),this.documentEffect.record(),Ar(this.microAppWindow.microApp)}rebuildEffectSnapshot(){this.windowEffect.rebuild(),this.documentEffect.rebuild(),gr(this.microAppWindow.microApp)}releaseGlobalEffect({umdMode:e=!1,clearData:t=!1,isPrerender:n=!1,keepAlive:o=!1,destroy:r=!1}){var a,i,s;this.windowEffect.release(!e&&!o&&!n||r),this.documentEffect.release(),null===(a=this.microAppWindow.microApp)||void 0===a||a.clearDataListener(),null===(i=this.microAppWindow.microApp)||void 0===i||i.clearGlobalDataListener(),t&&(li.clearData(this.microAppWindow.__MICRO_APP_NAME__),null===(s=this.microAppWindow.microApp)||void 0===s||s.clearData())}getSpecialProperties(e){var t;Jt(li.options.plugins)&&(this.commonActionForSpecialProperties(li.options.plugins.global),this.commonActionForSpecialProperties(null===(t=li.options.plugins.modules)||void 0===t?void 0:t[e]))}commonActionForSpecialProperties(e){if(Ut(e))for(const t of e)Jt(t)&&(Ut(t.scopeProperties)&&(this.scopeProperties=this.scopeProperties.concat(t.scopeProperties)),Ut(t.escapeProperties)&&(this.escapeProperties=this.escapeProperties.concat(t.escapeProperties)))}setPreRenderState(e){this.microAppWindow.__MICRO_APP_PRE_RENDER__=e}markUmdMode(e){this.microAppWindow.__MICRO_APP_UMD_MODE__=e}patchWith(e){this.sandboxReady=new Promise((t=>e(t)))}setMappingPropertiesWithRawDescriptor(e){let t,n;const o=Ya.rawWindow;o===o.parent?t=n=this.proxyWindow:(t=o.top,n=o.parent),jt(e,{top:this.createDescriptorForMicroAppWindow("top",t),parent:this.createDescriptorForMicroAppWindow("parent",n)}),$o.forEach((t=>{Ht(e,t,this.createDescriptorForMicroAppWindow(t,this.proxyWindow))}))}createDescriptorForMicroAppWindow(e,t){const{configurable:n=!0,enumerable:o=!0,writable:r,set:a}=Object.getOwnPropertyDescriptor(Ya.rawWindow,e)||{writable:!0};return{value:t,configurable:n,enumerable:o,writable:null!=r?r:!!a}}initGlobalKeysWhenStart(e,t,n,o){n.hasOwnProperty=e=>Gt.call(n,e)||Gt.call(Ya.rawWindow,e),this.setHijackProperty(e,n),o||this.patchRequestApi(e,t,n),this.setScopeProperties(n)}setHijackProperty(e,t){let n,o;jt(t,{eval:{configurable:!0,enumerable:!1,get:()=>(Mn(e),n||Ya.rawWindow.eval),set:e=>{n=e}},Image:{configurable:!0,enumerable:!1,get:()=>(Mn(e),o||Ya.ImageProxy),set:e=>{o=e}}})}patchRequestApi(e,t,n){let o=ya(t),r=ba(t),a=Pa(e,t);jt(n,{fetch:{configurable:!0,enumerable:!0,get:()=>o,set(e){o=ya(t,e)}},XMLHttpRequest:{configurable:!0,enumerable:!0,get:()=>r,set(e){r=ba(t,e)}},EventSource:{configurable:!0,enumerable:!0,get:()=>a,set(n){a=Pa(e,t,n)}}})}setScopeProperties(e){this.scopeProperties.forEach((t=>{Reflect.set(e,t,e[t])}))}patchRouter(e,t,n){const{microLocation:o,microHistory:r}=function(e,t){const n=ma(e,t);return{microLocation:n,microHistory:oa(e,n)}}(e,t);jt(n,{location:{configurable:!1,enumerable:!0,get:()=>o,set:e=>{Ya.rawWindow.location=e}},history:{configurable:!0,enumerable:!0,get:()=>r}})}initRouteState(e){Aa(this.microAppWindow.__MICRO_APP_NAME__,this.microAppWindow.location,e)}clearRouteState(e){wa(this.microAppWindow.__MICRO_APP_NAME__,this.microAppWindow.__MICRO_APP_URL__,this.microAppWindow.location,e)}setRouteInfoForKeepAliveApp(){ga(this.microAppWindow.__MICRO_APP_NAME__,this.microAppWindow.location)}removeRouteInfoForKeepAliveApp(){va(this.microAppWindow.__MICRO_APP_NAME__)}patchStaticElement(e){Mr(e,this.microAppWindow.__MICRO_APP_NAME__)}actionsBeforeExecScripts(e,t){this.patchStaticElement(e),this.clearHijackUmdHooks=this.hijackUmdHooks(this.appName,this.microAppWindow,t)}hijackUmdHooks(e,t,n){let o,r,a;return jt(t,{mount:{configurable:!0,get:()=>o,set:e=>{this.active&&Yt(e)&&!o&&n(o=e,r)}},unmount:{configurable:!0,get:()=>r,set:e=>{this.active&&Yt(e)&&!r&&n(o,r=e)}},[`micro-app-${e}`]:{configurable:!0,get:()=>a,set:e=>{this.active&&Jt(e)&&!a&&(a=e,n(a.mount,a.unmount))}}}),()=>{o=r=a=null}}setStaticAppState(e){this.microAppWindow.__MICRO_APP_STATE__=e}}Ra.activeCount=0;const Sa=["getComputedStyle","DOMParser","visualViewport","matchMedia","ResizeObserver","IntersectionObserver"],Ma=[/animationFrame$/i,/mutationObserver$/i,/height$|width$/i,/offset$/i,/selection$/i,/^range/i,/^screen/i,/^scroll/i,/X$|Y$/],Ca=["body","head","html","title"],Na=["childElementCount","children","firstElementChild","firstChild","lastElementChild","activeElement","fullscreenElement","pictureInPictureElement","pointerLockElement","styleSheets"],Oa=["append","contains","replaceChildren","createRange","getSelection","elementFromPoint","elementsFromPoint","getAnimations"],Da=["characterSet","compatMode","contentType","designMode","dir","doctype","embeds","fullscreenEnabled","hidden","implementation","lastModified","pictureInPictureEnabled","plugins","readyState","referrer","visibilityState","fonts"],Ia=["execCommand","createRange","exitFullscreen","exitPictureInPicture","getElementsByTagNameNS","hasFocus","prepend"];function xa(e,t,n){return function(e,t){const n=Ya.rawWindow;Sa.forEach((e=>{t[e]=Er(n[e],n)})),Object.getOwnPropertyNames(t).filter((e=>(Ma.some((o=>{if(o.test(e)&&e in t.parent){if(Yt(n[e]))t[e]=Er(n[e],n);else{const{configurable:o,enumerable:r}=Object.getOwnPropertyDescriptor(t,e)||{configurable:!0,enumerable:!0};o&&Ht(t,e,{configurable:o,enumerable:r,get:()=>n[e],set:t=>{n[e]=t}})}return!0}return!1})),en(t[e])&&e in n&&Ht(t[e],Symbol.hasInstance,{configurable:!0,enumerable:!1,value:o=>o instanceof n[e]||function(e,t){if(null==e)return!1;if(!Yt(t))throw new TypeError("Right-hand side of 'instanceof' is not callable");let n=Object.getPrototypeOf(e);for(;n;){if(n===t.prototype)return!0;n=Object.getPrototypeOf(n)}return!1}(o,t[e])}),/^on/.test(e)&&!jo.includes(e)))).forEach((o=>{const{enumerable:r,writable:a,set:i}=Object.getOwnPropertyDescriptor(t,o)||{enumerable:!0,writable:!0};try{Ht(t,o,{enumerable:r,configurable:!0,get:()=>n[o],set:(null!=a?a:i)?e=>{n[o]=Yt(e)?e.bind(t):e}:void 0})}catch(s){hn(s,e)}}))}(e,t),function(e,t){const n=Ya.rawWindow,o=new Set,r=new Proxy(e,{get:(e,a)=>"location"===a?t.proxyLocation:pn($o,a)?r:o.has(a)?Reflect.get(e,a):pn(t.escapeProperties,a)&&!Reflect.has(e,a)?Er(Reflect.get(n,a),n):Er(Reflect.get(e,a),e),set:(e,r,a)=>"location"===r?Reflect.set(n,r,a):(Reflect.has(e,r)||o.add(r),Reflect.set(e,r,a),pn(t.escapeProperties,r)&&(!Reflect.has(n,r)&&t.escapeKeys.add(r),Reflect.set(n,r,a)),!0),has:(e,t)=>t in e,deleteProperty:(e,o)=>!Reflect.has(e,o)||(t.escapeKeys.has(o)&&Reflect.deleteProperty(n,o),Reflect.deleteProperty(e,o))});t.proxyWindow=r}(t,n),function(e){const{rawWindow:t,rawAddEventListener:n,rawRemoveEventListener:o,rawDispatchEvent:r}=Ya,a=new Map,i=new Map;function s(n){return Uo.includes(n)?e:t}e.addEventListener=function(e,t,o){const r=a.get(e);r?r.add(t):a.set(e,new Set([t])),t&&(t.__MICRO_APP_MARK_OPTIONS__=o),n.call(s(e),e,t,o)},e.removeEventListener=function(e,t,n){const r=a.get(e);(null==r?void 0:r.size)&&r.has(t)&&r.delete(t),o.call(s(e),e,t,n)},e.dispatchEvent=function(e){return r.call(s(null==e?void 0:e.type),e)};const c=()=>{i.clear()},l=()=>{i.forEach(((t,n)=>{for(const o of t)e.addEventListener(n,o,null==o?void 0:o.__MICRO_APP_MARK_OPTIONS__)})),c()};return{reset:c,record:()=>{a.forEach(((e,t)=>{if(e.size){const n=i.get(t)||[];i.set(t,new Set([...n,...e]))}}))},rebuild:l,release:()=>{a.size&&(a.forEach(((e,t)=>{for(const n of e)o.call(s(t),t,n)})),a.clear())}}}(t)}function La(e,t,n){return function(e,t){const n=Ya.rawDocument,o=t.Document,r=t.document,a=o.prototype.createElement,i=o.prototype.createElementNS,s=o.prototype.createTextNode,c=o.prototype.createDocumentFragment,l=o.prototype.createComment,u=o.prototype.querySelector,p=o.prototype.querySelectorAll,d=o.prototype.getElementById,h=o.prototype.getElementsByClassName,m=o.prototype.getElementsByTagName,f=o.prototype.getElementsByName,_=o.prototype.elementFromPoint,A=o.prototype.caretRangeFromPoint;function g(t){return Dn(e),r===t?n:t}function w(t){var o,a,i;const s=g(this);return!t||Wn(t)||n!==s?u.call(s,t):null!==(i=null!==(a=null===(o=Wa.get(e))||void 0===o?void 0:o.querySelector(t))&&void 0!==a?a:u.call(r,t))&&void 0!==i?i:null}function v(t){var o,a;const i=g(this);if(!t||Wn(t)||n!==i)return p.call(i,t);const s=null!==(a=null===(o=Wa.get(e))||void 0===o?void 0:o.querySelectorAll(t))&&void 0!==a?a:[];return s.length?s:p.call(r,t)}o.prototype.caretRangeFromPoint=function(t,o){const r=_.call(n,t,o),a=A.call(n,t,o);return Cr(r,e),a},o.prototype.createElement=function(t,n){return Cr(a.call(this,t,n),e)},o.prototype.createElementNS=function(t,n,o){return Cr(i.call(this,t,n,o),e)},o.prototype.createTextNode=function(t){return Cr(s.call(this,t),e)},o.prototype.createDocumentFragment=function(){return Cr(c.call(this),e)},o.prototype.createComment=function(t){return Cr(l.call(this,t),e)},o.prototype.querySelector=w,o.prototype.querySelectorAll=v,o.prototype.getElementById=function(e){const t=g(this);if(Bn(e))return d.call(t,e);try{return w.call(this,`#${e}`)}catch(n){return d.call(t,e)}},o.prototype.getElementsByClassName=function(e){const t=g(this);if(Bn(e))return h.call(t,e);try{return v.call(this,`.${e}`)}catch(n){return h.call(t,e)}},o.prototype.getElementsByTagName=function(e){const t=g(this);if(Wn(e)||Bn(e))return m.call(t,e);if(/^script|base$/i.test(e))return m.call(r,e);try{return v.call(this,e)}catch(n){return m.call(t,e)}},o.prototype.getElementsByName=function(e){const t=g(this);if(Bn(e))return f.call(t,e);try{return v.call(this,`[name=${e}]`)}catch(n){return f.call(t,e)}}}(e,t),function(e,t,n){const o=Ya.rawDocument,r=t.Document,a=t.document,i=(e,t)=>{const{enumerable:n}=Object.getOwnPropertyDescriptor(r.prototype,e)||{enumerable:!0};return{configurable:!0,enumerable:n,get:t}},s=()=>{const t={};return[["documentURI",()=>n.proxyLocation.href],["URL",()=>n.proxyLocation.href],["documentElement",()=>o.documentElement],["scrollingElement",()=>o.scrollingElement],["forms",()=>r.prototype.querySelectorAll.call(a,"form")],["images",()=>r.prototype.querySelectorAll.call(a,"img")],["links",()=>r.prototype.querySelectorAll.call(a,"a")],["microAppElement",()=>{var t;return null===(t=Wa.get(e))||void 0===t?void 0:t.container}],["__MICRO_APP_NAME__",()=>e]].forEach((e=>{t[e[0]]=i(e[0],e[1])})),Na.forEach((e=>{t[e]=i(e,(()=>o[e]))})),Oa.forEach((e=>{t[e]=i(e,(()=>Er(o[e],o,"DOCUMENT")))})),Da.forEach((e=>{t[e]=i(e,(()=>o[e]))})),Ia.forEach((e=>{t[e]=i(e,(()=>Er(o[e],o,"DOCUMENT")))})),t};jt(r.prototype,s()),Ca.forEach((t=>{Ht(a,t,{enumerable:!0,configurable:!0,get:()=>(Dn(e),o[t]),set:e=>{o[t]=e}})}))}(e,t,n),function(e,t){const{rawDocument:n,rawAddEventListener:o,rawRemoveEventListener:r,rawDispatchEvent:a}=Ya,i=new Map,s=new Map;let c=null,l=null;const u=t.Document,p=t.document;function d(e,t){return Ko.includes(e)?t:n}function h(e){return"onclick"===e?e=>{Yt(c)&&r.call(n,"click",c,!1),Yt(e)?(c=e.bind(p),o.call(n,"click",c,!1)):c=e}:t=>{n[e]=Yt(t)?t.bind(p):t}}u.prototype.addEventListener=function(e,t,n){const r=Yt(t)?t.__MICRO_APP_BOUND_FUNCTION__=t.__MICRO_APP_BOUND_FUNCTION__||t.bind(this):t,a=i.get(e);a?a.add(t):i.set(e,new Set([t])),t&&(t.__MICRO_APP_MARK_OPTIONS__=n),o.call(d(e,this),e,r,n)},u.prototype.removeEventListener=function(e,t,n){const o=i.get(e);(null==o?void 0:o.size)&&o.has(t)&&o.delete(t);const a=(null==t?void 0:t.__MICRO_APP_BOUND_FUNCTION__)||t;r.call(d(e,this),e,a,n)},u.prototype.dispatchEvent=function(e){return a.call(d(null==e?void 0:e.type,this),e)},Object.getOwnPropertyNames(u.prototype).filter((e=>/^on/.test(e)&&!Go.includes(e))).forEach((t=>{const{enumerable:o,writable:r,set:a}=Object.getOwnPropertyDescriptor(u.prototype,t)||{enumerable:!0,writable:!0};try{Ht(u.prototype,t,{enumerable:o,configurable:!0,get:()=>"onclick"===t?c:n[t],set:(null!=r?r:a)?h(t):void 0})}catch(i){hn(i,e)}}));const m=()=>{s.clear(),l=null},f=()=>{l&&!c&&(p.onclick=l),s.forEach(((e,t)=>{for(const n of e)p.addEventListener(t,n,null==n?void 0:n.__MICRO_APP_MARK_OPTIONS__)})),m()};return{reset:m,record:()=>{l=c||l,i.forEach(((e,t)=>{if(e.size){const n=s.get(t)||[];s.set(t,new Set([...n,...e]))}}))},rebuild:f,release:()=>{Yt(c)&&r.call(n,"click",c),c=null,i.size&&(i.forEach(((e,t)=>{for(const n of e)r.call(d(t,p),t,(null==n?void 0:n.__MICRO_APP_BOUND_FUNCTION__)||n)})),i.clear())}}}(e,t)}function Ta(e,t,n,o){!function(e,t,n){const o=Ya.rawRootElement,r=Ya.rawRootNode,a=Ya.rawDocument,i=t.document,s=t.Node,c=t.Element,l=t.DocumentFragment,u=s.prototype.appendChild,p=s.prototype.insertBefore,d=s.prototype.replaceChild,h=s.prototype.removeChild,m=c.prototype.append,f=c.prototype.prepend,_=l.prototype.append,A=l.prototype.prepend,g=c.prototype.insertAdjacentElement,w=s.prototype.cloneNode,v=Object.getOwnPropertyDescriptor(c.prototype,"innerHTML"),y=Object.getOwnPropertyDescriptor(s.prototype,"parentNode"),b=Object.getOwnPropertyDescriptor(s.prototype,"ownerDocument"),P=e=>(sn(e)||function(e){return"[object HTMLBaseElement]"===$t(e)}(e))&&e.__PURE_ELEMENT__,E=e=>e===n.microHead?a.head:e===n.microBody?a.body:e;s.prototype.appendChild=function(t){return Cr(t,e),P(t)?u.call(this,t):r.prototype.appendChild.call(E(this),t)},s.prototype.insertBefore=function(t,n){return Cr(t,e),P(t)?p.call(this,t,n):r.prototype.insertBefore.call(E(this),t,n)},s.prototype.replaceChild=function(t,n){return Cr(t,e),P(t)?d.call(this,t,n):r.prototype.replaceChild.call(E(this),t,n)},s.prototype.removeChild=function(e){return P(e)||this.contains(e)?h.call(this,e):r.prototype.removeChild.call(E(this),e)},l.prototype.append=c.prototype.append=function(...e){let t=0,n=!1;for(;t<e.length;)e[t]=on(e[t])?e[t]:i.createTextNode(e[t]),P(e[t])&&(n=!0),t++;return n?(cn(this)?_:m).call(this,...e):o.prototype.append.call(E(this),...e)},l.prototype.prepend=c.prototype.prepend=function(...e){let t=0,n=!1;for(;t<e.length;)e[t]=on(e[t])?e[t]:i.createTextNode(e[t]),P(e[t])&&(n=!0),t++;return n?(cn(this)?A:f).call(this,...e):o.prototype.prepend.call(E(this),...e)},c.prototype.insertAdjacentElement=function(t,n){return Cr(n,e),P(n)?g.call(this,t,n):o.prototype.insertAdjacentElement.call(E(this),t,n)},Ht(s.prototype,"baseURI",{configurable:!0,enumerable:!0,get:()=>n.proxyWindow.location.href}),Ht(s.prototype,"ownerDocument",{configurable:!0,enumerable:!0,get(){var e;return this.__PURE_ELEMENT__||this===i?null===(e=b.get)||void 0===e?void 0:e.call(this):i}}),Ht(s.prototype,"parentNode",Nr(e,y)),s.prototype.getRootNode=function(){return i},s.prototype.cloneNode=function(t){return Cr(w.call(this,t),e)},Ht(c.prototype,"innerHTML",{configurable:!0,enumerable:!0,get(){var e;return null===(e=v.get)||void 0===e?void 0:e.call(this)},set(t){var n;null===(n=v.set)||void 0===n||n.call(this,t),Array.from(this.children).forEach((t=>{nn(t)&&Cr(t,e)}))}});const R=new Proxy(t.Image,{construct(t,n){const o=new t(...n);return Cr(o,e),o}});Ht(t,"Image",{configurable:!0,writable:!0,value:R})}(e,n,o),function(e,t){const n=t.Element,o=n.prototype.setAttribute;n.prototype.setAttribute=function(t,r){/^micro-app(-\S+)?/i.test(this.tagName)&&"data"===t&&this.setAttribute!==n.prototype.setAttribute?this.setAttribute(t,r):((("src"===t||"srcset"===t)&&/^(img|script|video|audio|source|embed)$/i.test(this.tagName)||"href"===t&&/^(link|image)$/i.test(this.tagName))&&(r=vn(r,e)),o.call(this,t,r))};const r=[[t.HTMLImageElement.prototype,"src"],[t.HTMLScriptElement.prototype,"src"],[t.HTMLLinkElement.prototype,"href"],[t.SVGImageElement.prototype,"href"]];r.forEach((([t,n])=>{const{enumerable:o,configurable:r,get:a,set:i}=Object.getOwnPropertyDescriptor(t,n)||{enumerable:!0,configurable:!0};Ht(t,n,{enumerable:o,configurable:r,get:function(){return null==a?void 0:a.call(this)},set:function(t){null==i||i.call(this,vn(t,e))}})}))}(t,n)}class Ba{constructor(e,t){this.active=!1,this.escapeProperties=[],this.escapeKeys=new Set,this.updateIframeBase=()=>{var e;null===(e=this.baseElement)||void 0===e||e.setAttribute("href",fn(this.url).origin+this.proxyLocation.pathname)},this.appName=e,this.url=t;const n=Ya.rawWindow.location,o=n.protocol+"//"+n.host;this.deleteIframeElement=this.createIframeElement(e,o+n.pathname),this.microAppWindow=this.iframe.contentWindow,this.patchIframe(this.microAppWindow,(n=>{this.createIframeTemplate(this.microAppWindow),this.getSpecialProperties(e),this.proxyLocation=function(e,t,n,o){const r=Ya.rawWindow.history,a=fn(t),i=a.protocol+"//"+a.host,s=a.pathname+a.search+a.hash,c=n.history;return n.rawReplaceState=c.replaceState,Ft(c,oa(e,n.location)),jt(c,{scrollRestoration:{configurable:!0,enumerable:!0,get:()=>r.scrollRestoration,set(e){r.scrollRestoration=e}}}),_a(e,s,n.location,"prevent"),ma(e,t,n,a,o,i)}(e,t,this.microAppWindow,o),this.windowEffect=xa(e,this.microAppWindow,this),this.documentEffect=La(e,this.microAppWindow,this),Ta(e,t,this.microAppWindow,this),this.initStaticGlobalKeys(e,t,this.microAppWindow),n()}))}createIframeElement(e,t){this.iframe=Tn("iframe");const n={id:e,src:li.options.iframeSrc||t,style:"display: none","powered-by":"micro-app"};return Object.keys(n).forEach((e=>this.iframe.setAttribute(e,n[e]))),Ya.rawDocument.body.appendChild(this.iframe),()=>mn((()=>{var e,t;null===(t=null===(e=this.iframe)||void 0===e?void 0:e.parentNode)||void 0===t||t.removeChild(this.iframe),this.iframe=null}))}start({baseroute:e,defaultPage:t,disablePatchRequest:n}){this.active||(this.active=!0,this.initRouteState(t),this.removeHistoryListener=ea(this.microAppWindow.__MICRO_APP_NAME__),Jr(this.microAppWindow.__MICRO_APP_NAME__)&&(this.microAppWindow.__MICRO_APP_BASE_ROUTE__=this.microAppWindow.__MICRO_APP_BASE_URL__=e),n||this.createIframeBase(),1==++Ya.activeSandbox&&(Qa(),ca()),++Ba.activeCount)}stop({umdMode:e,keepRouteState:t,destroy:n,clearData:o}){var r;this.active&&(this.recordAndReleaseEffect({clearData:o},!e||n),this.clearRouteState(t),null===(r=this.removeHistoryListener)||void 0===r||r.call(this),e&&!n||(this.deleteIframeElement(),this.escapeKeys.forEach((e=>{Reflect.deleteProperty(Ya.rawWindow,e)})),this.escapeKeys.clear(),this.clearHijackUmdHooks()),0==--Ya.activeSandbox&&(za(),la()),--Ba.activeCount,this.active=!1)}initStaticGlobalKeys(e,t,n){n.__MICRO_APP_ENVIRONMENT__=!0,n.__MICRO_APP_NAME__=e,n.__MICRO_APP_URL__=t,n.__MICRO_APP_PUBLIC_PATH__=wn(t),n.__MICRO_APP_BASE_ROUTE__="",n.__MICRO_APP_WINDOW__=n,n.__MICRO_APP_PRE_RENDER__=!1,n.__MICRO_APP_UMD_MODE__=!1,n.__MICRO_APP_PROXY_WINDOW__=this.proxyWindow,n.__MICRO_APP_SANDBOX__=this,n.__MICRO_APP_SANDBOX_TYPE__="iframe",n.rawWindow=Ya.rawWindow,n.rawDocument=Ya.rawDocument,n.microApp=Ft(new _r(e),{removeDomScope:Ln,pureCreateElement:Tn,location:this.proxyLocation,router:ua})}recordAndReleaseEffect(e,t=!1){t?this.resetEffectSnapshot():this.recordEffectSnapshot(),this.releaseGlobalEffect(e)}resetEffectSnapshot(){var e,t;null===(e=this.windowEffect)||void 0===e||e.reset(),null===(t=this.documentEffect)||void 0===t||t.reset(),wr(this.microAppWindow.microApp)}recordEffectSnapshot(){var e,t;null===(e=this.windowEffect)||void 0===e||e.record(),null===(t=this.documentEffect)||void 0===t||t.record(),Ar(this.microAppWindow.microApp)}rebuildEffectSnapshot(){var e,t;null===(e=this.windowEffect)||void 0===e||e.rebuild(),null===(t=this.documentEffect)||void 0===t||t.rebuild(),gr(this.microAppWindow.microApp)}releaseGlobalEffect({clearData:e=!1}){var t,n,o,r,a;null===(t=this.windowEffect)||void 0===t||t.release(),null===(n=this.documentEffect)||void 0===n||n.release(),null===(o=this.microAppWindow.microApp)||void 0===o||o.clearDataListener(),null===(r=this.microAppWindow.microApp)||void 0===r||r.clearGlobalDataListener(),e&&(li.clearData(this.microAppWindow.__MICRO_APP_NAME__),null===(a=this.microAppWindow.microApp)||void 0===a||a.clearData())}setPreRenderState(e){this.microAppWindow.__MICRO_APP_PRE_RENDER__=e}markUmdMode(e){this.microAppWindow.__MICRO_APP_UMD_MODE__=e}patchIframe(e,t){const n=e.document;this.sandboxReady=new Promise((o=>{!function r(){setTimeout((()=>{try{e.document===n?r():(e.stop(),t(o))}catch(a){r()}}),0)}()}))}createIframeTemplate(e){const t=e.document;!function(e){for(;null==e?void 0:e.firstChild;)e.removeChild(e.firstChild)}(t);const n=t.createElement("html");n.innerHTML="<head></head><body></body>",t.appendChild(n),this.microBody=t.body,this.microHead=t.head}createIframeBase(){this.baseElement=Tn("base"),this.updateIframeBase(),this.microHead.appendChild(this.baseElement)}getSpecialProperties(e){var t;Jt(li.options.plugins)&&(this.commonActionForSpecialProperties(li.options.plugins.global),this.commonActionForSpecialProperties(null===(t=li.options.plugins.modules)||void 0===t?void 0:t[e]))}commonActionForSpecialProperties(e){if(Ut(e))for(const t of e)Jt(t)&&Ut(t.escapeProperties)&&(this.escapeProperties=this.escapeProperties.concat(t.escapeProperties))}initRouteState(e){Aa(this.microAppWindow.__MICRO_APP_NAME__,this.microAppWindow.location,e)}clearRouteState(e){wa(this.microAppWindow.__MICRO_APP_NAME__,this.microAppWindow.__MICRO_APP_URL__,this.microAppWindow.location,e)}setRouteInfoForKeepAliveApp(){ga(this.microAppWindow.__MICRO_APP_NAME__,this.microAppWindow.location)}removeRouteInfoForKeepAliveApp(){va(this.microAppWindow.__MICRO_APP_NAME__)}patchStaticElement(e){Mr(e,this.microAppWindow.__MICRO_APP_NAME__)}actionsBeforeExecScripts(e,t){this.patchStaticElement(e),this.clearHijackUmdHooks=this.hijackUmdHooks(this.appName,this.microAppWindow,t)}hijackUmdHooks(e,t,n){let o,r,a;return jt(t,{mount:{configurable:!0,get:()=>o,set:e=>{this.active&&Yt(e)&&!o&&n(o=e,r)}},unmount:{configurable:!0,get:()=>r,set:e=>{this.active&&Yt(e)&&!r&&n(o,r=e)}},[`micro-app-${e}`]:{configurable:!0,get:()=>a,set:e=>{this.active&&Jt(e)&&!a&&(a=e,n(a.mount,a.unmount))}}}),()=>{o=r=a=null}}setStaticAppState(e){this.microAppWindow.__MICRO_APP_STATE__=e}}Ba.activeCount=0;const Wa=new Map;class ka{constructor({name:e,url:t,container:n,scopecss:o,useSandbox:r,inline:a,iframe:i,ssrUrl:s,isPrefetch:c,prefetchLevel:l,routerMode:u}){this.state=fo.CREATED,this.keepAliveState=null,this.loadSourceLevel=0,this.umdHookMount=null,this.umdHookUnmount=null,this.umdMode=!1,this.sandBox=null,this.fiber=!1,Wa.set(e,this),this.name=e,this.url=t,this.useSandbox=r,this.scopecss=this.useSandbox&&o,this.iframe=null!=i&&i,this.inline=this.getInlineModeState(a),this.routerMode=u||Io,this.container=null!=n?n:null,this.ssrUrl=null!=s?s:"",this.isPrefetch=null!=c&&c,this.isPrerender=3===l,this.prefetchLevel=l,this.source={html:null,links:new Set,scripts:new Set},this.loadSourceCode(),this.createSandbox()}loadSourceCode(){this.setAppState(fo.LOADING),eo.getInstance().run(this,pr)}onLoad({html:e,defaultPage:t,routerMode:n,baseroute:o,disablePatchRequest:r}){var a;if(2==++this.loadSourceLevel){if(this.source.html=e,this.isUnmounted())return;if(this.isPrefetch){if(this.isPrerender){const e=Tn("div");e.setAttribute("prerender","true"),null===(a=this.sandBox)||void 0===a||a.setPreRenderState(!0),this.mount({container:e,inline:this.inline,fiber:!0,defaultPage:t||"",disablePatchRequest:null!=r&&r,routerMode:n,baseroute:o||""})}}else kn(this.container).mount(this)}}onLoadError(e){this.loadSourceLevel=-1,this.isUnmounted()||(this.onerror(e),this.setAppState(fo.LOAD_FAILED))}mount({container:e,inline:t,routerMode:n,defaultPage:o,baseroute:r,disablePatchRequest:a,fiber:i}){if(2!==this.loadSourceLevel)return this.container=e,this.isPrerender=!1,Jn(this,"statechange",{appState:fo.LOADING}),this.setAppState(fo.LOADING);this.createSandbox(),this.setAppState(fo.BEFORE_MOUNT);const s=()=>{var s,c,l,u,p,d,h,m;if(this.isPrerender&&(m=this.container,"[object HTMLDivElement]"===$t(m))&&this.container.hasAttribute("prerender"))this.container=this.cloneContainer(e,this.container,!1),null===(s=this.sandBox)||void 0===s||s.rebuildEffectSnapshot(),null===(c=this.preRenderEvents)||void 0===c||c.forEach((e=>e())),this.isPrerender=!1,this.preRenderEvents=null,ua.attachToURL(this.name),null===(l=this.sandBox)||void 0===l||l.setPreRenderState(!1);else{this.container=e,this.inline=this.getInlineModeState(t),this.fiber=i,this.routerMode=n;const s=()=>{Yn(this.container,this.name,Ao.BEFOREMOUNT)};if(this.isPrerender?(null!==(u=this.preRenderEvents)&&void 0!==u?u:this.preRenderEvents=[]).push(s):s(),this.setAppState(fo.MOUNTING),Jn(this,"statechange",{appState:fo.MOUNTING}),this.cloneContainer(this.container,this.source.html,!this.umdMode),null===(p=this.sandBox)||void 0===p||p.start({umdMode:this.umdMode,baseroute:r,defaultPage:o,disablePatchRequest:a}),this.umdMode){null===(h=this.sandBox)||void 0===h||h.rebuildEffectSnapshot();try{this.handleMounted(this.umdHookMount(li.getData(this.name,!0)))}catch(f){dn("An error occurred when mount \n",this.name,f)}}else null===(d=this.sandBox)||void 0===d||d.actionsBeforeExecScripts(this.container,((e,t)=>{var n;if(!this.umdMode&&!this.isUnmounted()&&(this.umdHookMount=Yt(e)?e:null,this.umdHookUnmount=Yt(t)?t:null,Yt(this.umdHookMount)&&Yt(this.umdHookUnmount))){null===(n=this.sandBox)||void 0===n||n.markUmdMode(this.umdMode=!0);try{this.getAppState()===fo.MOUNTED?this.umdHookMount(li.getData(this.name,!0)):this.handleMounted(this.umdHookMount(li.getData(this.name,!0)))}catch(f){dn("An error occurred when mount \n",this.name,f)}}})),function(e,t){const n=e.fiber?[]:null,o=Array.from(e.source.scripts),r=[],a=[];for(const i of o){const o=Ro.script.getInfo(i),s=o.appSpace[e.name];s.defer||s.async?(!o.isExternal||o.code||zo(e,o)?r.push(o.code):r.push(Zn(i,e.name)),a.push([i,o]),zo(e,o)&&(t.moduleCount=t.moduleCount?++t.moduleCount:1)):$n(n,(()=>{sr(i,e,o),t(!1)}))}r.length?yn(r,(e=>{const t=a[e.index][1];t.code=t.code||e.data}),(n=>{t.errorCount=t.errorCount?++t.errorCount:1,dn(n,e.name)}),(()=>{a.forEach((([o,r])=>{Vt(r.code)&&$n(n,(()=>{sr(o,e,r,t),!zo(e,r)&&t(!1)}))})),n?(n.push((()=>Promise.resolve(t(qt(t.moduleCount)||t.errorCount===r.length)))),qn(n)):t(qt(t.moduleCount)||t.errorCount===r.length)})):n?(n.push((()=>Promise.resolve(t(!0)))),qn(n)):t(!0)}(this,(e=>{this.umdMode||!0!==e||this.handleMounted()}))}};this.sandBox?this.sandBox.sandboxReady.then((()=>!this.isUnmounted()&&s())):s()}handleMounted(e){var t,n;const o=()=>{const t=()=>this.actionsAfterMounted();Zt(e)?e.then(t).catch((e=>{dn("An error occurred in window.mount \n",this.name,e),t()})):t()};this.isPrerender?(null===(t=this.preRenderEvents)||void 0===t||t.push(o),null===(n=this.sandBox)||void 0===n||n.recordAndReleaseEffect({isPrerender:!0})):o()}actionsAfterMounted(){var e;this.isUnmounted()||(this.setAppState(fo.MOUNTED),Vn(this.getMicroAppGlobalHook(wo.ONMOUNT),this.name,wo.ONMOUNT,li.getData(this.name,!0)),Jn(this,"statechange",{appState:fo.MOUNTED}),Jn(this,"mounted"),Yn(this.container,this.name,Ao.MOUNTED),this.isHidden()&&(null===(e=this.sandBox)||void 0===e||e.recordAndReleaseEffect({keepAlive:!0})))}unmount({destroy:e,clearData:t,keepRouteState:n,unmountcb:o}){var r;e=e||this.state===fo.LOAD_FAILED,this.setAppState(fo.UNMOUNT);try{this.handleUnmounted(e,t,n,o,null===(r=this.umdHookUnmount)||void 0===r?void 0:r.call(this,li.getData(this.name,!0)))}catch(a){dn("An error occurred when unmount \n",this.name,a)}}handleUnmounted(e,t,n,o,r){Jn(this,"statechange",{appState:fo.UNMOUNT}),Jn(this,"unmount"),Vn(this.getMicroAppGlobalHook(wo.ONUNMOUNT),this.name,wo.ONUNMOUNT);const a=()=>this.actionsAfterUnmounted({destroy:e,clearData:t,keepRouteState:n,unmountcb:o});Zt(r)?(Ln(),r.then(a).catch((e=>{dn("An error occurred in window.unmount \n",this.name,e),a()}))):a()}actionsAfterUnmounted({destroy:e,clearData:t,keepRouteState:n,unmountcb:o}){var r;this.umdMode&&this.container&&!e&&this.cloneContainer(this.source.html,this.container,!1),null===(r=this.sandBox)||void 0===r||r.stop({umdMode:this.umdMode,keepRouteState:n&&!e,destroy:e,clearData:t||e}),Yn(this.container,this.name,Ao.UNMOUNT),this.clearOptions(e),null==o||o()}clearOptions(e){var t,n;this.isPrerender=!1,this.preRenderEvents=null,this.setKeepAliveState(null),this.container?(this.container.innerHTML="",this.container=null):this.umdMode||null===(n=null===(t=this.sandBox)||void 0===t?void 0:t.deleteIframeElement)||void 0===n||n.call(t),this.iframe&&!this.umdMode&&(this.sandBox=null),e&&this.actionsForCompletelyDestroy(),Ln()}actionsForCompletelyDestroy(){var e,t;null===(t=null===(e=this.sandBox)||void 0===e?void 0:e.deleteIframeElement)||void 0===t||t.call(e),Ro.script.deleteInlineInfo(this.source.scripts),Wa.delete(this.name)}hiddenKeepAliveApp(e){var t,n;this.setKeepAliveState(yo.KEEP_ALIVE_HIDDEN),Jn(this,"appstate-change",{appState:"afterhidden"}),Yn(this.container,this.name,Ao.AFTERHIDDEN),Vr(this.name)&&(null===(t=this.sandBox)||void 0===t||t.removeRouteInfoForKeepAliveApp()),2!==this.loadSourceLevel?kn(this.container).unmount():(this.container=this.cloneContainer(Tn("div"),this.container,!1),null===(n=this.sandBox)||void 0===n||n.recordAndReleaseEffect({keepAlive:!0})),null==e||e()}showKeepAliveApp(e){var t,n;const o=this.container;this.container=e,null===(t=this.sandBox)||void 0===t||t.rebuildEffectSnapshot(),Jn(this,"appstate-change",{appState:"beforeshow"}),Yn(e,this.name,Ao.BEFORESHOW),this.setKeepAliveState(yo.KEEP_ALIVE_SHOW),this.cloneContainer(this.container,o,!1),Vr(this.name)&&(null===(n=this.sandBox)||void 0===n||n.setRouteInfoForKeepAliveApp()),Jn(this,"appstate-change",{appState:"aftershow"}),Yn(this.container,this.name,Ao.AFTERSHOW)}onerror(e){Jn(this,"statechange",{appState:fo.LOAD_FAILED}),Yn(this.container,this.name,Ao.ERROR,e)}parseHtmlString(e){var t;return(new((null===(t=this.sandBox)||void 0===t?void 0:t.proxyWindow)?this.sandBox.proxyWindow.DOMParser:Ya.rawWindow.DOMParser)).parseFromString(e,"text/html").body}cloneContainer(e,t,n){return t&&e&&(e.innerHTML="",Array.from(n?this.parseHtmlString(t.innerHTML).childNodes:t.childNodes).forEach((t=>{e.appendChild(t)}))),e}createSandbox(){this.useSandbox&&!this.sandBox&&(this.sandBox=this.iframe?new Ba(this.name,this.url):new Ra(this.name,this.url))}setAppState(e){var t;this.state=e,null===(t=this.sandBox)||void 0===t||t.setStaticAppState(e)}getAppState(){return this.state}setKeepAliveState(e){this.keepAliveState=e}getKeepAliveState(){return this.keepAliveState}isUnmounted(){return fo.UNMOUNT===this.state}isHidden(){return yo.KEEP_ALIVE_HIDDEN===this.keepAliveState}getMicroAppGlobalHook(e){var t,n;const o=null===(n=null===(t=this.sandBox)||void 0===t?void 0:t.proxyWindow)||void 0===n?void 0:n[e];return Yt(o)?o:null}querySelector(e){return this.container?Ya.rawElementQuerySelector.call(this.container,e):null}querySelectorAll(e){return this.container?Ya.rawElementQuerySelectorAll.call(this.container,e):[]}getInlineModeState(e){var t;return null!==(t=this.iframe||e)&&void 0!==t&&t}}function Ua(e){var t,n;return null!==(n=null===(t=Wa.get(e))||void 0===t?void 0:t.iframe)&&void 0!==n&&n}const Fa=new WeakMap;function Ha(e){var t;return null!==(t=Fa.get(e))&&void 0!==t?t:e}function ja(e,t){if(Fa.has(e))return Fa.get(e);if(an(e)){if(e.hasAttribute("exclude")){const t=document.createComment("style element with exclude attribute ignored by micro-app");return Fa.set(e,t),t}return t.scopecss&&!e.hasAttribute("ignore")?so(e,t):e}if(rn(e)){if(e.hasAttribute("exclude")||rr(e.getAttribute("href"),t.name)){const t=document.createComment("link element with exclude attribute ignored by micro-app");return Fa.set(e,t),t}if(e.hasAttribute("ignore")||ar(e.getAttribute("href"),t.name)||e.href&&Yt(li.options.excludeAssetFilter)&&li.options.excludeAssetFilter(e.href))return e;const{address:n,linkInfo:o,replaceComment:r}=So(e,null,t,!0);if(n&&o){const r=function(e,t,n,o){const r=Tn("style"),a=()=>{Co(t,e,r,n,n.appSpace[t.name].attrs),uo(o)};return n.code?mn(a):Zn(e,t.name).then((e=>{n.code=e,a()})).catch((e=>{dn(e,t.name),po(o)})),r}(n,t,o,e);return Fa.set(e,r),r}return r?(Fa.set(e,r),r):e}if(sn(e)){if(e.src&&Yt(li.options.excludeAssetFilter)&&li.options.excludeAssetFilter(e.src))return e;const{replaceComment:n,address:o,scriptInfo:r}=nr(e,null,t,!0)||{};if(o&&r){const n=r.isExternal?function(e,t,n,o){const r=Xo(t,n)?Tn("script"):document.createComment(`dynamic script with src='${e}' extract by micro-app`),a=()=>uo(o),i=()=>{const i=Object.getOwnPropertyDescriptor(Ya.rawDocument,"currentScript");i&&!i.configurable||Object.defineProperty(Ya.rawDocument,"currentScript",{value:o,configurable:!0}),sr(e,t,n,a,r),!zo(t,n)&&a()};return n.code||zo(t,n)?mn(i):Zn(e,t.name).then((e=>{n.code=e,i()})).catch((e=>{dn(e,t.name),po(o)})),r}(o,t,r,e):function(e,t,n){const o=Xo(t,n)?Tn("script"):document.createComment("dynamic inline script extract by micro-app");return sr(e,t,n,void 0,o),o}(o,t,r);return Fa.set(e,n),n}return n?(Fa.set(e,n),n):e}return e}function Ka(e,t,n,o,r){const a=Ga(n,o,e);if(a){if(!Ua(e.name)&&ln(a)&&t!==Ya.rawRemoveChild){const t=Object.getOwnPropertyDescriptor(o,"parentNode");t&&!t.configurable||o.__MICRO_APP_HAS_DPN__||jt(o,{parentNode:{configurable:!0,get(){var t,n;const o=Ya.rawParentNodeDesc.get.call(this);return ln(o)&&e.container?(null===(n=(t=li.options).getRootElementParentNode)||void 0===n?void 0:n.call(t,this,e.name))||document.body:o}},__MICRO_APP_HAS_DPN__:{configurable:!0,get:()=>!0}})}if(r&&!a.contains(r)){if(t===Ya.rawInsertBefore&&n.contains(r)){const i=Array.from(n.childNodes).indexOf(r);if(a.childNodes[i])return $a(t,a,o,a.childNodes[i],e)}return Ya.rawAppendChild.call(a,o)}return t!==Ya.rawRemoveChild||a.contains(o)?$a(t,a,o,r,e):n.contains(o)?t.call(n,o):o}return $a(t,n,o,r,e)}function Ga(e,t,n){if(n){if(e===document.head)return n.iframe&&sn(t)?n.sandBox.microHead:n.querySelector("micro-app-head");if(e===document.body||e===document.body.parentNode)return n.iframe&&sn(t)?n.sandBox.microBody:n.querySelector("micro-app-body");if(n.iframe&&sn(t))return n.sandBox.microBody}return null}function $a(e,t,n,o,r){return(a=e)===Ya.rawAppend||a===Ya.rawPrepend||a===Ya.rawFragmentAppend||a===Ya.rawFragmentPrepend?((null==r?void 0:r.iframe)&&sn(n)&&(e===Ya.rawFragmentAppend?e=Ya.rawAppend:e===Ya.rawFragmentPrepend&&(e=Ya.rawPrepend)),e.call(t,n)):e.call(t,n,o);var a}function qa(e,t,n,o){const r=Sn();if(on(t)&&!t.__PURE_ELEMENT__&&(t.__MICRO_APP_NAME__||r)){Cr(t,t.__MICRO_APP_NAME__||r);const a=Wa.get(t.__MICRO_APP_NAME__);if(null==a?void 0:a.container)return an(t)&&e.getRootNode()instanceof ShadowRoot&&t.setAttribute("ignore","true"),function(e,t){nn(t)&&(/^(img|script)$/i.test(t.tagName)?(t.hasAttribute("src")&&Ya.rawSetAttribute.call(t,"src",vn(t.getAttribute("src"),e.url)),t.hasAttribute("srcset")&&Ya.rawSetAttribute.call(t,"srcset",vn(t.getAttribute("srcset"),e.url))):/^(link|image)$/i.test(t.tagName)&&t.hasAttribute("href")&&Ya.rawSetAttribute.call(t,"href",vn(t.getAttribute("href"),e.url)))}(a,t),Ka(a,o,e,ja(t,a),n&&Ha(n))}return $a(o,e,t,n)}function Qa(){!function(){const e=Ya.rawDocument,t=Ya.rawRootDocument;function n(t){return function(e){return"[object ProxyDocument]"===$t(e)}(t)?e:t}function o(t){var o,r;const a=n(this),i=Sn();return i&&t&&!Wn(t)&&e===a?null!==(r=null===(o=Wa.get(i))||void 0===o?void 0:o.querySelector(t))&&void 0!==r?r:null:Ya.rawQuerySelector.call(a,t)}function r(t){var o,r;const a=n(this),i=Sn();return i&&t&&!Wn(t)&&e===a?null!==(r=null===(o=Wa.get(i))||void 0===o?void 0:o.querySelectorAll(t))&&void 0!==r?r:[]:Ya.rawQuerySelectorAll.call(a,t)}t.prototype.createElement=function(e,t){return Va(Ya.rawCreateElement.call(n(this),e,t))},t.prototype.createElementNS=function(e,t,o){return Va(Ya.rawCreateElementNS.call(n(this),e,t,o))},t.prototype.createDocumentFragment=function(){return Va(Ya.rawCreateDocumentFragment.call(n(this)))},t.prototype.createComment=function(e){return Va(Ya.rawCreateComment.call(n(this),e))},t.prototype.querySelector=o,t.prototype.querySelectorAll=r,t.prototype.getElementById=function(e){const t=n(this);if(!Sn()||Bn(e))return Ya.rawGetElementById.call(t,e);try{return o.call(t,`#${e}`)}catch(r){return Ya.rawGetElementById.call(t,e)}},t.prototype.getElementsByClassName=function(e){const t=n(this);if(!Sn()||Bn(e))return Ya.rawGetElementsByClassName.call(t,e);try{return r.call(t,`.${e}`)}catch(o){return Ya.rawGetElementsByClassName.call(t,e)}},t.prototype.getElementsByTagName=function(e){var t;const o=n(this),a=Sn();if(!a||Wn(e)||Bn(e)||!(null===(t=Wa.get(a))||void 0===t?void 0:t.inline)&&/^script$/i.test(e))return Ya.rawGetElementsByTagName.call(o,e);try{return r.call(o,e)}catch(i){return Ya.rawGetElementsByTagName.call(o,e)}},t.prototype.getElementsByName=function(e){const t=n(this);if(!Sn()||Bn(e))return Ya.rawGetElementsByName.call(t,e);try{return r.call(t,`[name=${e}]`)}catch(o){return Ya.rawGetElementsByName.call(t,e)}}}();const e=Ya.rawRootElement,t=Ya.rawRootNode,n=Ya.rawDocumentFragment;function o(e){const t=On()||Sn();if((e===document.body||e===document.head)&&t){const n=Wa.get(t);if(null==n?void 0:n.container){if(e===document.body)return n.querySelector("micro-app-body");if(e===document.head)return n.querySelector("micro-app-head")}}return e}function r(e,t,n,o,r){if(e){const e=On()||Sn();if(e&&Ua(e)){const n=Wa.get(e);if(nn(a=t)&&"MICRO-APP-HEAD"===a.tagName.toUpperCase())return n.sandBox.microHead[r](o);if(ln(t))return n.sandBox.microBody[r](o)}}var a;return n}t.prototype.appendChild=function(e){return qa(this,e,null,Ya.rawAppendChild)},t.prototype.insertBefore=function(e,t){return qa(this,e,t,Ya.rawInsertBefore)},t.prototype.replaceChild=function(e,t){return qa(this,e,t,Ya.rawReplaceChild)},t.prototype.removeChild=function(e){if(null==e?void 0:e.__MICRO_APP_NAME__){const n=Wa.get(e.__MICRO_APP_NAME__);if(null==n?void 0:n.container)return Ka(n,Ya.rawRemoveChild,this,Ha(e));try{return Ya.rawRemoveChild.call(this,e)}catch(t){return(null==e?void 0:e.parentNode)&&Ya.rawRemoveChild.call(e.parentNode,e)}}return Ya.rawRemoveChild.call(this,e)},n.prototype.append=e.prototype.append=function(...e){let t=0;for(;t<e.length;){let n=e[t];n=on(n)?n:Ya.rawCreateTextNode.call(Ya.rawDocument,n),qa(this,Va(n),null,cn(this)?Ya.rawFragmentAppend:Ya.rawAppend),t++}},n.prototype.prepend=e.prototype.prepend=function(...e){let t=e.length;for(;t>0;){let n=e[t-1];n=on(n)?n:Ya.rawCreateTextNode.call(Ya.rawDocument,n),qa(this,Va(n),null,cn(this)?Ya.rawFragmentPrepend:Ya.rawPrepend),t--}},e.prototype.insertAdjacentElement=function(e,t){var n;if((null==t?void 0:t.__MICRO_APP_NAME__)&&nn(t)){const o=Wa.get(t.__MICRO_APP_NAME__);if(null==o?void 0:o.container){const r=ja(t,o);if(!nn(r))return t;const a=null!==(n=Ga(this,r,o))&&void 0!==n?n:this;return Ya.rawInsertAdjacentElement.call(a,e,r)}}return Ya.rawInsertAdjacentElement.call(this,e,t)},e.prototype.querySelector=function(e){var t;const n=null!==(t=o(this))&&void 0!==t?t:this,a=Ya.rawElementQuerySelector.call(n,e);return r(Qt(a)&&n!==this,n,a,e,"querySelector")},e.prototype.querySelectorAll=function(e){var t;const n=null!==(t=o(this))&&void 0!==t?t:this,a=Ya.rawElementQuerySelectorAll.call(n,e);return r(!a.length&&n!==this,n,a,e,"querySelectorAll")},e.prototype.setAttribute=function(t,n){if(/^micro-app(-\S+)?/i.test(this.tagName)&&"data"===t&&this.setAttribute!==e.prototype.setAttribute)this.setAttribute(t,n);else{const e=this.__MICRO_APP_NAME__||Sn();if(e&&Wa.has(e)&&(("src"===t||"srcset"===t)&&/^(img|script|video|audio|source|embed)$/i.test(this.tagName)||"href"===t&&/^(link|image)$/i.test(this.tagName))){n=vn(n,Wa.get(e).url)}Ya.rawSetAttribute.call(this,t,n)}},Ht(t.prototype,"parentNode",{configurable:!0,enumerable:!0,get(){var e,t,n;const o=On()||Sn();if(o&&this===Ya.rawDocument.firstElementChild){const r=null===(n=null===(t=null===(e=Wa.get(o))||void 0===e?void 0:e.sandBox)||void 0===t?void 0:t.proxyWindow)||void 0===n?void 0:n.document;if(r)return r}return Ya.rawParentNodeDesc.get.call(this)}}),Ht(e.prototype,"innerHTML",{configurable:!0,enumerable:!0,get(){return Ya.rawInnerHTMLDesc.get.call(this)},set(e){Ya.rawInnerHTMLDesc.set.call(this,e);const t=this.__MICRO_APP_NAME__||Sn();Array.from(this.children).forEach((e=>{nn(e)&&t&&Cr(e,t)}))}}),t.prototype.cloneNode=function(e){return Cr(Ya.rawCloneNode.call(this,e),this.__MICRO_APP_NAME__)}}function Va(e){return Cr(e,Sn())}function za(){Ln(),function(){const e=Ya.rawRootDocument;e.prototype.createElement=Ya.rawCreateElement,e.prototype.createElementNS=Ya.rawCreateElementNS,e.prototype.createDocumentFragment=Ya.rawCreateDocumentFragment,e.prototype.querySelector=Ya.rawQuerySelector,e.prototype.querySelectorAll=Ya.rawQuerySelectorAll,e.prototype.getElementById=Ya.rawGetElementById,e.prototype.getElementsByClassName=Ya.rawGetElementsByClassName,e.prototype.getElementsByTagName=Ya.rawGetElementsByTagName,e.prototype.getElementsByName=Ya.rawGetElementsByName}();const e=Ya.rawRootElement,t=Ya.rawRootNode;t.prototype.appendChild=Ya.rawAppendChild,t.prototype.insertBefore=Ya.rawInsertBefore,t.prototype.replaceChild=Ya.rawReplaceChild,t.prototype.removeChild=Ya.rawRemoveChild,t.prototype.cloneNode=Ya.rawCloneNode,e.prototype.append=Ya.rawAppend,e.prototype.prepend=Ya.rawPrepend,e.prototype.querySelector=Ya.rawElementQuerySelector,e.prototype.querySelectorAll=Ya.rawElementQuerySelectorAll,e.prototype.setAttribute=Ya.rawSetAttribute,Ht(t.prototype,"parentNode",Ya.rawParentNodeDesc),Ht(e.prototype,"innerHTML",Ya.rawInnerHTMLDesc)}let Xa=!1;const Ya={activeSandbox:0};function Ja(){if(Bt){const e=window.rawWindow||Function("return window")(),t=window.rawDocument||Function("return document")(),n=e.Document||Function("return Document")(),o=e.Element,r=e.Node,a=e.EventTarget,i=e.DocumentFragment,s=r.prototype.appendChild,c=r.prototype.insertBefore,l=r.prototype.replaceChild,u=r.prototype.removeChild,p=o.prototype.setAttribute,d=o.prototype.append,h=o.prototype.prepend,m=i.prototype.append,f=i.prototype.prepend,_=r.prototype.cloneNode,A=o.prototype.querySelector,g=o.prototype.querySelectorAll,w=o.prototype.insertAdjacentElement,v=Object.getOwnPropertyDescriptor(o.prototype,"innerHTML"),y=Object.getOwnPropertyDescriptor(r.prototype,"parentNode"),b=n.prototype.createElement,P=n.prototype.createElementNS,E=n.prototype.createTextNode,R=n.prototype.createDocumentFragment,S=n.prototype.createComment,M=n.prototype.querySelector,C=n.prototype.querySelectorAll,N=n.prototype.getElementById,O=n.prototype.getElementsByClassName,D=n.prototype.getElementsByTagName,I=n.prototype.getElementsByName,x=new Proxy(e.Image,{construct:(e,t)=>Cr(new e(...t),Sn())}),L=e.setInterval,T=e.setTimeout,B=e.clearInterval,W=e.clearTimeout,k=e.history.pushState,U=e.history.replaceState,F=a.prototype.addEventListener,H=a.prototype.removeEventListener,j=a.prototype.dispatchEvent;window.__MICRO_APP_BASE_APPLICATION__=!0,Ft(Ya,{supportModuleScript:"noModule"in document.createElement("script"),rawWindow:e,rawDocument:t,rawRootDocument:n,rawRootElement:o,rawRootNode:r,rawDocumentFragment:i,rawSetAttribute:p,rawAppendChild:s,rawInsertBefore:c,rawReplaceChild:l,rawRemoveChild:u,rawAppend:d,rawPrepend:h,rawFragmentAppend:m,rawFragmentPrepend:f,rawCloneNode:_,rawElementQuerySelector:A,rawElementQuerySelectorAll:g,rawInsertAdjacentElement:w,rawInnerHTMLDesc:v,rawParentNodeDesc:y,rawCreateElement:b,rawCreateElementNS:P,rawCreateDocumentFragment:R,rawCreateTextNode:E,rawCreateComment:S,rawQuerySelector:M,rawQuerySelectorAll:C,rawGetElementById:N,rawGetElementsByClassName:O,rawGetElementsByTagName:D,rawGetElementsByName:I,ImageProxy:x,rawSetInterval:L,rawSetTimeout:T,rawClearInterval:B,rawClearTimeout:W,rawPushState:k,rawReplaceState:U,rawAddEventListener:F,rawRemoveEventListener:H,rawDispatchEvent:j}),function(){if(!Xa){Xa=!0;const e=Tn("style");Ya.rawSetAttribute.call(e,"type","text/css"),e.textContent=`\n${li.tagName}, micro-app-body { display: block; } \nmicro-app-head { display: none; }`,Ya.rawDocument.head.appendChild(e)}}()}}function Za(e){class t extends HTMLElement{constructor(){super(...arguments),this.isWaiting=!1,this.cacheData=null,this.connectedCount=0,this.connectStateMap=new Map,this.appName="",this.appUrl="",this.ssrUrl="",this.version=Tt,this.handleAttributeUpdate=()=>{this.isWaiting=!1;const e=gn(this.getAttribute("name")),t=An(this.getAttribute("url"),this.appName);if(this.legalAttribute("name",e)&&this.legalAttribute("url",t)){const n=Wa.get(e);if(e!==this.appName&&n&&!n.isUnmounted()&&!n.isHidden()&&!n.isPrefetch)return this.setAttribute("name",this.appName),dn(`app name conflict, an app named ${e} is running`);e===this.appName&&t===this.appUrl||(e===this.appName?this.unmount(!0,(()=>{this.actionsForAttributeChange(e,t,n)})):this.getKeepAliveModeResult()?(this.handleHiddenKeepAliveApp(),this.actionsForAttributeChange(e,t,n)):this.unmount(!1,(()=>{this.actionsForAttributeChange(e,t,n)})))}else e!==this.appName&&this.setAttribute("name",this.appName)}}static get observedAttributes(){return["name","url"]}connectedCallback(){Object.getPrototypeOf(this)!==t.prototype&&Object.setPrototypeOf(this,t.prototype);const e=++this.connectedCount;this.connectStateMap.set(e,!0);const n=this.appName&&this.appUrl;mn((()=>{this.connectStateMap.get(e)&&(Yn(this,this.appName,Ao.CREATED),n&&this.handleConnected())}))}disconnectedCallback(){this.connectStateMap.set(this.connectedCount,!1),this.handleDisconnected()}reload(e){return new Promise((t=>{const n=()=>{this.removeEventListener(Ao.MOUNTED,n),this.removeEventListener(Ao.AFTERSHOW,n),t(!0)};this.addEventListener(Ao.MOUNTED,n),this.addEventListener(Ao.AFTERSHOW,n),this.handleDisconnected(e,(()=>{this.handleConnected()}))}))}handleDisconnected(e=!1,t){const n=Wa.get(this.appName);!n||n.isUnmounted()||n.isHidden()||(this.getKeepAliveModeResult()&&!e?this.handleHiddenKeepAliveApp(t):this.unmount(e,t))}attributeChangedCallback(e,t,n){if(this.legalAttribute(e,n)&&this[e===ho.NAME?"appName":"appUrl"]!==n)if(e!==ho.URL||this.appUrl&&this.connectStateMap.get(this.connectedCount))if(e!==ho.NAME||this.appName&&this.connectStateMap.get(this.connectedCount))this.isWaiting||(this.isWaiting=!0,mn(this.handleAttributeUpdate));else{const e=gn(n);if(!e)return dn(`Invalid attribute name ${n}`,this.appName);this.cacheData&&(li.setData(e,this.cacheData),this.cacheData=null),this.appName=e,e!==n&&this.setAttribute("name",this.appName),this.handleInitialNameAndUrl()}else{if(!(n=An(n,this.appName)))return dn(`Invalid attribute url ${n}`,this.appName);this.appUrl=n,this.handleInitialNameAndUrl()}}handleInitialNameAndUrl(){this.connectStateMap.get(this.connectedCount)&&this.handleConnected()}handleConnected(){if(this.appName&&this.appUrl)if(this.getDisposeResult("shadowDOM")&&!this.shadowRoot&&Yt(this.attachShadow)&&this.attachShadow({mode:"open"}),this.updateSsrUrl(this.appUrl),Wa.has(this.appName)){const e=Wa.get(this.appName),t=e.ssrUrl||e.url,n=this.ssrUrl||this.appUrl;e.isHidden()&&e.url===this.appUrl?this.handleShowKeepAliveApp(e):t===n&&(e.isUnmounted()||e.isPrefetch&&this.sameCoreOptions(e))?this.handleMount(e):e.isPrefetch||e.isUnmounted()?this.handleCreateApp():dn(`app name conflict, an app named ${this.appName} with url ${t} is running`)}else this.handleCreateApp()}actionsForAttributeChange(e,t,n){var o;this.updateSsrUrl(t),this.appName=e,this.appUrl=t,(null!==(o=this.shadowRoot)&&void 0!==o?o:this).innerHTML="",e!==this.getAttribute("name")&&this.setAttribute("name",this.appName),n?n.isHidden()?n.url===this.appUrl?this.handleShowKeepAliveApp(n):dn(`app name conflict, an app named ${this.appName} is running`):n.url===this.appUrl&&n.ssrUrl===this.ssrUrl?this.handleMount(n):this.handleCreateApp():this.handleCreateApp()}legalAttribute(e,t){return!(!Vt(t)||!t)||(dn(`unexpected attribute ${e}, please check again`,this.appName),!1)}handleCreateApp(){const e=()=>{var e;return new ka({name:this.appName,url:this.appUrl,container:null!==(e=this.shadowRoot)&&void 0!==e?e:this,scopecss:this.useScopecss(),useSandbox:this.useSandbox(),inline:this.getDisposeResult("inline"),iframe:this.getDisposeResult("iframe"),ssrUrl:this.ssrUrl,routerMode:this.getMemoryRouterMode()})},t=Wa.get(this.appName);t?t.isPrerender?this.unmount(!0,e):(t.actionsForCompletelyDestroy(),e()):e()}handleMount(e){e.isPrefetch=!1,e.setAppState(fo.BEFORE_MOUNT),mn((()=>this.mount(e)))}mount(e){var t;e.mount({container:null!==(t=this.shadowRoot)&&void 0!==t?t:this,inline:this.getDisposeResult("inline"),routerMode:this.getMemoryRouterMode(),baseroute:this.getBaseRouteCompatible(),defaultPage:this.getDefaultPage(),disablePatchRequest:this.getDisposeResult("disable-patch-request"),fiber:this.getDisposeResult("fiber")})}unmount(e,t){const n=Wa.get(this.appName);n&&!n.isUnmounted()&&n.unmount({destroy:e||this.getDestroyCompatibleResult(),clearData:this.getDisposeResult("clear-data"),keepRouteState:this.getDisposeResult("keep-router-state"),unmountcb:t})}handleHiddenKeepAliveApp(e){const t=Wa.get(this.appName);!t||t.isUnmounted()||t.isHidden()||t.hiddenKeepAliveApp(e)}handleShowKeepAliveApp(e){mn((()=>{var t;return e.showKeepAliveApp(null!==(t=this.shadowRoot)&&void 0!==t?t:this)}))}getDisposeResult(e){return(this.compatibleProperties(e)||!!li.options[e])&&this.compatibleDisableProperties(e)}compatibleProperties(e){return"disable-scopecss"===e?this.hasAttribute("disable-scopecss")||this.hasAttribute("disableScopecss"):"disable-sandbox"===e?this.hasAttribute("disable-sandbox")||this.hasAttribute("disableSandbox"):this.hasAttribute(e)}compatibleDisableProperties(e){return"disable-scopecss"===e?"false"!==this.getAttribute("disable-scopecss")&&"false"!==this.getAttribute("disableScopecss"):"disable-sandbox"===e?"false"!==this.getAttribute("disable-sandbox")&&"false"!==this.getAttribute("disableSandbox"):"false"!==this.getAttribute(e)}useScopecss(){return!(this.getDisposeResult("disable-scopecss")||this.getDisposeResult("shadowDOM"))}useSandbox(){return!this.getDisposeResult("disable-sandbox")}sameCoreOptions(e){return e.scopecss===this.useScopecss()&&e.useSandbox===this.useSandbox()&&e.iframe===this.getDisposeResult("iframe")}getBaseRouteCompatible(){var e,t;return null!==(t=null!==(e=this.getAttribute("baseroute"))&&void 0!==e?e:this.getAttribute("baseurl"))&&void 0!==t?t:""}getDestroyCompatibleResult(){return this.getDisposeResult("destroy")||this.getDisposeResult("destory")}getKeepAliveModeResult(){return this.getDisposeResult("keep-alive")&&!this.getDestroyCompatibleResult()}updateSsrUrl(e){if(this.getDisposeResult("ssr"))if(this.getDisposeResult("disable-memory-router")||this.getDisposeResult("disableSandbox")){const t=Ya.rawWindow.location;this.ssrUrl=vn(t.pathname+t.search,e)}else{let t=function(e,t){const n=Kr(e);if(!n)return"";const o=fn(n,t);return o.origin+o.pathname+o.search}(this.appName,e);const n=this.getDefaultPage();if(!t&&n){const o=fn(n,e);t=o.origin+o.pathname+o.search}this.ssrUrl=t}else this.ssrUrl&&(this.ssrUrl="")}getDefaultPage(){return ua.getDefaultPage(this.appName)||this.getAttribute("default-page")||this.getAttribute("defaultPage")||""}getMemoryRouterMode(){return Zr(this.getAttribute("router-mode"),this.compatibleProperties("disable-memory-router")&&this.compatibleDisableProperties("disable-memory-router"))}setAttribute(e,t){if("data"===e)if(Jt(t)){const e={};Object.getOwnPropertyNames(t).forEach((n=>{Vt(n)&&0===n.indexOf("__")||(e[n]=t[n])})),this.data=e}else"[object Object]"!==t&&hn("property data must be an object",this.appName);else Ya.rawSetAttribute.call(this,e,t)}getRouterEventDelay(){let e=parseInt(this.getAttribute("router-event-delay"));return isNaN(e)&&(e=parseInt(Yt(li.options["router-event-delay"])?li.options["router-event-delay"](this.appName):li.options["router-event-delay"])),isNaN(e)?0:e}set data(e){this.appName?li.setData(this.appName,e):this.cacheData=e}get data(){return this.appName?li.getData(this.appName,!0):this.cacheData?this.cacheData:null}get publicPath(){return wn(this.appUrl)}get baseRoute(){return this.getBaseRouteCompatible()}}window.customElements.define(e,t)}function ei(e,t){if(!Bt)return dn("preFetch is only supported in browser environment");bn((()=>{const n=Xt(t)?t:li.options.prefetchDelay;setTimeout((()=>{!function(e){Yt(e)&&(e=e()),Ut(e)&&e.reduce(((e,t)=>e.then((()=>{return e=t,Pn((t=>{var n,o,r,a,i,s;if(Jt(e)&&navigator.onLine)if(e.name=gn(e.name),e.url=An(e.url,e.name),e.name&&e.url&&!Wa.has(e.name)){const c=new ka({name:e.name,url:e.url,isPrefetch:!0,scopecss:!(null!==(o=null!==(n=e["disable-scopecss"])&&void 0!==n?n:e.disableScopecss)&&void 0!==o?o:li.options["disable-scopecss"]),useSandbox:!(null!==(a=null!==(r=e["disable-sandbox"])&&void 0!==r?r:e.disableSandbox)&&void 0!==a?a:li.options["disable-sandbox"]),inline:null!==(i=e.inline)&&void 0!==i?i:li.options.inline,iframe:null!==(s=e.iframe)&&void 0!==s?s:li.options.iframe,prefetchLevel:e.level&&Oo.includes(e.level)?e.level:li.options.prefetchLevel&&Oo.includes(li.options.prefetchLevel)?li.options.prefetchLevel:2}),l=c.onLoad,u=c.onLoadError;c.onLoad=n=>{c.isPrerender&&Ft(n,{defaultPage:e["default-page"],routerMode:Zr(e["router-mode"]),baseroute:e.baseroute,disablePatchRequest:e["disable-patch-request"]}),t(),l.call(c,n)},c.onLoadError=(...e)=>{t(),u.call(c,...e)}}else t();else t()}));var e}))),Promise.resolve())}(e)}),Xt(n)?n:3e3)}))}function ti(e,t,n){if(Ut(e)){const o=e.filter((e=>Vt(e)&&un(e,t)&&!n.hasInfo(e)));yn(o.map((e=>Zn(e))),(e=>{const r=o[e.index];"js"===t?n.hasInfo(r)||n.setInfo(r,{code:e.data,isExternal:!1,appSpace:{}}):n.hasInfo(r)||n.setInfo(r,{code:e.data,appSpace:{}})}),(e=>{dn(e)}))}}function ni({excludeHiddenApp:e=!1,excludePreRender:t=!1}={}){const n=[];return Wa.forEach(((o,r)=>{o.isUnmounted()||o.isPrefetch&&(!o.isPrerender||t)||e&&o.isHidden()||n.push(r)})),n}function oi(){return Array.from(Wa.keys())}function ri(e,t){const n=Wa.get(gn(e));return new Promise((o=>{if(n)if(n.isUnmounted()||n.isPrefetch)n.isPrerender?n.unmount({destroy:!!(null==t?void 0:t.destroy),clearData:!!(null==t?void 0:t.clearData),keepRouteState:!1,unmountcb:o.bind(null,!0)}):((null==t?void 0:t.destroy)&&n.actionsForCompletelyDestroy(),o(!0));else if(n.isHidden())(null==t?void 0:t.destroy)?n.unmount({destroy:!0,clearData:!0,keepRouteState:!0,unmountcb:o.bind(null,!0)}):(null==t?void 0:t.clearAliveState)?n.unmount({destroy:!1,clearData:!!t.clearData,keepRouteState:!0,unmountcb:o.bind(null,!0)}):o(!0);else{const e=kn(n.container),r=()=>{e.removeEventListener(Ao.UNMOUNT,r),e.removeEventListener(Ao.AFTERHIDDEN,a),o(!0)},a=()=>{e.removeEventListener(Ao.UNMOUNT,r),e.removeEventListener(Ao.AFTERHIDDEN,a),o(!0)};if(e.addEventListener(Ao.UNMOUNT,r),e.addEventListener(Ao.AFTERHIDDEN,a),null==t?void 0:t.destroy){let t,n;e.hasAttribute("destroy")&&(t=e.getAttribute("destroy")),e.hasAttribute("destory")&&(n=e.getAttribute("destory")),e.setAttribute("destroy","true"),e.parentNode.removeChild(e),e.removeAttribute("destroy"),Vt(t)&&e.setAttribute("destroy",t),Vt(n)&&e.setAttribute("destory",n)}else if((null==t?void 0:t.clearAliveState)&&e.hasAttribute("keep-alive")){const n=e.getAttribute("keep-alive");e.removeAttribute("keep-alive");let o=null;t.clearData&&(o=e.getAttribute("clear-data"),e.setAttribute("clear-data","true")),e.parentNode.removeChild(e),e.setAttribute("keep-alive",n),Vt(o)&&e.setAttribute("clear-data",o)}else{let n=null;(null==t?void 0:t.clearData)&&(n=e.getAttribute("clear-data"),e.setAttribute("clear-data","true")),e.parentNode.removeChild(e),Vt(n)&&e.setAttribute("clear-data",n)}}else hn(`app ${e} does not exist when unmountApp`),o(!1)}))}function ai(e){return Array.from(Wa.keys()).reduce(((t,n)=>t.then((()=>ri(n,e)))),Promise.resolve(!0))}function ii(e,t){return new Promise((n=>{const o=Wa.get(gn(e));if(o){const r=o.container&&kn(o.container);r?n(r.reload(t)):(hn(`app ${e} is not rendered, cannot use reload`),n(!1))}else hn(`app ${e} does not exist when reload app`),n(!1)}))}function si(e){return new Promise((t=>{if(!Jt(e))return dn("renderApp options must be an object");const n=nn(e.container)?e.container:Vt(e.container)?document.querySelector(e.container):null;if(!nn(n))return dn("Target container is not a DOM element.");const o=Tn(li.tagName);for(const s in e)if("onDataChange"===s)Yt(e[s])&&o.addEventListener("datachange",e[s]);else if("lifeCycles"===s){const t=e[s];if(Jt(t))for(const e in t)e.toUpperCase()in Ao&&Yt(t[e])&&o.addEventListener(e.toLowerCase(),t[e])}else"container"!==s&&o.setAttribute(s,e[s]);const r=()=>{i(),t(!0)},a=()=>{i(),t(!1)},i=()=>{o.removeEventListener(Ao.MOUNTED,r),o.removeEventListener(Ao.ERROR,a)};o.addEventListener(Ao.MOUNTED,r),o.addEventListener(Ao.ERROR,a),n.appendChild(o)}))}class ci extends fr{constructor(){super(...arguments),this.tagName="micro-app",this.hasInit=!1,this.options={},this.router=ua,this.preFetch=ei,this.unmountApp=ri,this.unmountAllApps=ai,this.getActiveApps=ni,this.getAllApps=oi,this.reload=ii,this.renderApp=si}start(e){var t,n,o;if(!Bt||!window.customElements)return dn("micro-app is not supported in this environment");if(this.hasInit)return dn("microApp.start executed repeatedly");if(this.hasInit=!0,null==e?void 0:e.tagName){if(!/^micro-app(-\S+)?/.test(e.tagName))return dn(`${e.tagName} is invalid tagName`);this.tagName=e.tagName}if(Ja(),window.customElements.get(this.tagName))return hn(`element ${this.tagName} is already defined`);if(Jt(e)&&(this.options=e,e["disable-scopecss"]=null!==(t=e["disable-scopecss"])&&void 0!==t?t:e.disableScopecss,e["disable-sandbox"]=null!==(n=e["disable-sandbox"])&&void 0!==n?n:e.disableSandbox,e.preFetchApps&&ei(e.preFetchApps),e.globalAssets&&(Jt(o=e.globalAssets)&&bn((()=>{ti(o.js,"js",Ro.script),ti(o.css,"css",Ro.link)}))),Jt(e.plugins))){const t=e.plugins.modules;if(Jt(t))for(const e in t){const n=gn(e);n&&e!==n&&(t[n]=t[e],delete t[e])}}Za(this.tagName)}}const li=new ci,ui=Object.freeze(Object.defineProperty({__proto__:null,EventCenterForMicroApp:_r,MicroApp:ci,default:li,getActiveApps:ni,getAllApps:oi,preFetch:ei,pureCreateElement:Tn,reload:ii,removeDomScope:Ln,renderApp:si,unmountAllApps:ai,unmountApp:ri,version:Tt},Symbol.toStringTag,{value:"Module"})),pi=(e="")=>e.split(" ").filter((e=>!!e.trim())),di=(e,t)=>{e&&t.trim()&&e.classList.add(...pi(t))};let hi;const mi=(()=>{var e;if(void 0!==hi)return hi;const t=document.createElement("div");t.className="el-scrollbar__wrap",t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const n=t.offsetWidth;t.style.overflow="scroll";const o=document.createElement("div");o.style.width="100%",t.appendChild(o);const r=o.offsetWidth;return null==(e=t.parentNode)||e.removeChild(t),hi=n-r,hi})();let fi,_i;function Ai(e){if(((e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)})(e,"content-screenfull")){((e,t)=>{e&&t.trim()&&e.classList.remove(...pi(t))})(e,"content-screenfull"),document.documentElement.style.overflow="",document.body.style.borderRight="",window.scrollTo(0,_i);const t=e._v_fullscreen_normal;t&&t()}else{_i=window.scrollY,di(e,"content-screenfull"),document.documentElement.style.overflow="hidden",document.body.style.borderRight=mi+"px solid transparent";const t=e._v_fullscreen_big;t&&t()}}const gi={mounted(e,t){switch(t.arg){case"top":fi=document.createElement("span"),fi.innerHTML='<svg data-v-3e070dd0="" viewBox="0 0 1024 1024" width="1em" height="1em"><path fill="currentColor" d="m160 96.064l192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872l-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"></path></svg>',fi.className="absolute-wrap cursor",fi.style.top=t.value+"px",di(e,"relative-wrap"),e.appendChild(fi),fi.addEventListener("click",(()=>{Ai(e)}),!1);break;case"big":e._v_fullscreen_big=t.value;break;case"normal":e._v_fullscreen_normal=t.value}},unmounted(e){fi&&(fi.removeEventListener("click",(()=>{Ai(e)}),!1),fi=null)}};gi.install=function(e){e.directive("fullscreen",gi)};const wi=Object.freeze(Object.defineProperty({__proto__:null,fullscreen:gi},Symbol.toStringTag,{value:"Module"}));const vi=s({__name:"App",setup(e){const n=c(z);return(e,o)=>{const a=b("router-view"),i=X;return t(),u(i,{locale:l(n)},{default:w((()=>[r(a)])),_:1},8,["locale"])}}});const yi=window.__MICRO_APP_ENVIRONMENT__?[]:["/login","/error/401","/error/404"];let bi,Pi=[];function Ei(e,t){const n=Le(e,t);if(n.forEach((e=>{Lt.addRoute(e)})),N().setRoutes(It.concat(n)),window.__MICRO_APP_BASE_APPLICATION__&&(Pi=It.concat(n)),window.__MICRO_APP_ENVIRONMENT__){const e=`/${window.__MICRO_APP_NAME__}`;Te(It.concat(n),e),window.microApp.dispatch({[window.__MICRO_APP_NAME__]:{routes:It.concat(n)}})}}Lt.beforeEach((async(e,t,n)=>{bi=Y.service({lock:!0,text:"",background:"transparent"});const o=Be();var r;if(document.title=(r=e.meta.title)?`${r} - APP`:"APP",window.__MICRO_APP_BASE_APPLICATION__){const t=e.path.split("/")[1],r=e.path.slice(t.length+1)||"/";if(Object.keys(te).includes(t)){return(await Ce((()=>Promise.resolve().then((()=>ui))),void 0)).default.setData(t,{to:{path:r,query:e.query,params:e.params}}),o.name||o.getInfo(),n(),!1}}window.__MICRO_APP_ENVIRONMENT__&&(e.redirect||window.microApp.dispatch({[window.__MICRO_APP_NAME__]:{finalRouterPath:e.path}}));if(Re())if("/login"===e.path)n({path:"/"});else{if(o.name)window.__MICRO_APP_BASE_APPLICATION__&&Pi.length>0&&(a=N().addRoutes,i=Pi,a.map((e=>e.path)).join("")!==i.map((e=>e.path)).join("")&&N().setRoutes(Pi)),n(),function(){const e=document.querySelector(".app-content");e&&(e.scrollTop=0)}();else try{const t=await o.getInfo();Ei(xt,t.menus.map((e=>e.name))),n(e)}catch(s){console.error("permission"+s),I.error(s.message),Se(),n(`/login?redirect=${e.path}`)}}else-1!==yi.indexOf(e.path)?n():window.__MICRO_APP_ENVIRONMENT__?window.rawWindow.location.href=te[ee]+"/login":n(`/login?redirect=${e.path}`);var a,i})),window.__MICRO_APP_ENVIRONMENT__&&window.microApp.addDataListener((e=>{e.to&&Lt.push({path:e.to.path,query:e.to.query})})),Lt.afterEach((()=>{bi.close()})),li.start({iframeSrc:"/main-app//empty.html","router-mode":"native",disableScopecss:!0,preFetchApps:()=>{const e=[];for(const t in te)t!==ee&&e.push({name:t,url:te[t],iframe:!0});return e}});const Ri=C(vi);!async function(e){console.warn("%c\n    Published 0.0.0\n    app name main-app\n    Build date: 8/9/2024, 7:15:15 PM","color: #fc4d50"),Object.keys(wi).forEach((t=>{wi[t].install(e)})),e.provide("tablePageKey",{total:"total",page:"pageNum",pageSize:"pageSize",data:"data.data.records",totalData:"data.data.total",pageSizeVal:20}),e.provide("responseKey","data.data")}(Ri),Ri.use(J).use(Z).use(Lt),Ri.mount("#app"),function(){{const e='\n    var _hmt = _hmt || [];\n    (function() {\n      var hm = document.createElement("script");\n      hm.src = "https://hm.baidu.com/hm.js?eca9a0fa2a40bc6e94d515264bc335c5";\n      var s = document.getElementsByTagName("script")[0]; \n      s.parentNode.insertBefore(hm, s);\n    })();\n    ',t=document.createElement("script");t.innerHTML=e,document.head.appendChild(t)}}();export{Ce as _};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/mock-prod-B7NoyyWH.js","assets/lib-Du4tlIoz.js","assets/element-plus-C2MwbI6u.js","assets/element-plus-BtgxXVGR.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
