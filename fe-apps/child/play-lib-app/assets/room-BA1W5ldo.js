import{v as e}from"./element-plus-ZpKcekI1.js";import{ac as t,E as n,ae as i,j as o,e as a,M as s,w as r,ad as c,H as l}from"./three.module-CLEMhXSw.js";import{u as d}from"./index-QsaRmXn2.js";import{g as m}from"./index-xe9CM43D.js";import{M as u}from"./event-listener-SFCxphOL.js";import{h as p,A as v,v as h,_ as f,y as w,o as j,j as g,P as M,u as x,k as y}from"./lib-RIRnLom_.js";const E={class:"app-content-no-padding",style:{height:"calc(100% + 32px)",position:"relative"}},P=p({__name:"room",setup(p){const P=new u(F,F),L=v(!0),H=v();let R,W,_,k=!1,A=0,S=0,Y=0,z=0,T=0,X=0,b=0,C=0;async function J(){const e=H.value;_=new t,W=new n(75,e.clientWidth/e.clientHeight,1,1100);const d=new i(500,60,40);d.scale(-1,1,1);const u=(new o).load(m()+"/three.js/panorama/textures/room.jpg",(()=>{L.value=!1}),void 0,(()=>{L.value=!1}));u.colorSpace=a;const p=new s({map:u}),v=new r(d,p);_.add(v),R=new c,R.setPixelRatio(window.devicePixelRatio),R.setSize(e.clientWidth,e.clientHeight),H.value.appendChild(R.domElement),function(){const e=H.value;e.addEventListener("pointerdown",q)}(),R.setAnimationLoop((function(){if(_&&R&&W){!1===k&&(Y+=.1),T=Math.max(-85,Math.min(85,T)),b=l.degToRad(90-T),C=l.degToRad(Y);const e=500*Math.sin(b)*Math.cos(C),t=500*Math.cos(b),n=500*Math.sin(b)*Math.sin(C);W.lookAt(e,t,n),R.render(_,W)}}))}function q(e){!1!==e.isPrimary&&(k=!0,A=e.clientX,S=e.clientY,z=Y,X=T,document.addEventListener("pointermove",B),document.addEventListener("pointerup",D))}function B(e){!1!==e.isPrimary&&(Y=.1*(A-e.clientX)+z,T=.1*(e.clientY-S)+X)}function D(e){!1!==e.isPrimary&&(k=!1,document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",D))}function F(e){if(W&&e){const t=W.fov+.05*e.deltaY;W.fov=l.clamp(t,10,75),W.updateProjectionMatrix()}}return d((function(){if(R&&W){const e=H.value;R.setSize(e.clientWidth,e.clientHeight),W.aspect=e.clientWidth/e.clientHeight,W.updateProjectionMatrix()}})),h((()=>{J()})),f((()=>{R&&(R.dispose(),R=null),W&&(W.clear(),W=null),_&&(_.clear(),_=null)})),w((()=>{H.value.removeEventListener("pointerdown",q),P.destroy()})),(t,n)=>{const i=e;return j(),g("div",E,[M(y("div",{ref_key:"threeJs",ref:H,style:{height:"100%",width:"100%",overflow:"hidden"}},null,512),[[i,x(L)]])])}}});export{P as default};
